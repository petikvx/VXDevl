
<HTML>
<HEAD>
   <TITLE>How To Remove A File Virus</TITLE>
   
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#C0C0C0" LINK="#800000" VLINK="#800000" ALINK="#800000" BACKGROUND="epback01.gif">

<CENTER><P><B><FONT COLOR="#004080"><FONT SIZE=+3>How to Remove a File
Virus</FONT></FONT></B></P></CENTER>

<P>
<HR></P>

<DL>
<DL>
<P><FONT SIZE=-1><A HREF="#IsitaCompanionVirus">Is it a Companion Virus?<BR>
</A><A HREF="#BeforeYouCleanaFilevirusLearnMore">Before You Clean a File
virus, Learn More<BR>
</A><A HREF="#Backitup">Back it up</A> <BR>
<A HREF="#FileVirusesTestCleaningonYourBackupCopies">Test Cleaning on Your
Backup Copies<BR>
</A><A HREF="#IfYourScannerClaimsitCanRemovetheVirus">If Your Scanner Claims
it Can Remove the Virus <BR>
</A><A HREF="#IfYourScannerClaimstheVirusisNotRemovable">If Your Scanner
Claims the Virus is Not Removable<BR>
</A><A HREF="#WhenYouareReadytoClean">When You are Ready to Clean...</A></FONT></P>
</DL>

<DT>
<HR WIDTH="100%"></DT>

<P><A NAME="IsitaCompanionVirus"></A><B><FONT SIZE=+2>Is it a Companion
Virus?</FONT></B></P>

<P>Companion viruses can be removed manually and completely, with no damage
to your system. Simply traverse directories, starting at the root, and
look for all COM files having a corresponding EXE file in the same directory,
where the COM file is the size of the virus. Then delete the COM file.
</P>

<P>For instance, if your system as the AIDS II virus, and you find a file
named &quot;ABC. COM&quot; and &quot;ABC. EXE&quot; in a directory, and
ABC.COM file is 8064 bytes, then ABC. COM is the virus. Simply delete ABC.
COM. </P>

<P><A NAME="BeforeYouCleanaFilevirusLearnMore"></A><B><FONT SIZE=+2>Before
You Clean a File virus, Learn More</FONT></B></P>

<P>Look up the virus in V-Base. </P>

<P>What file types does it infect? Does it overwrite (making it unremovable)?
Does it encrypt (if part of the file is encrypted, removal is less likely.)
</P>

<P>Is it stealth? Does it have other properties that might interfere with
detection or removal? </P>

<P>How does it spread? (Be sure to avoid this condition when it is in memory!)
</P>

<P><A NAME="Backitup"></A><B><FONT SIZE=+2>Back it up</FONT></B></P>

<P>Copy all infected files to floppy. </P>

<P>Place this disk in A: of an infected machine, and scan it. </P>

<P>Generate a report </P>

<P>Let your scanner generate a report of all infected files. </P>

<P>Print this out, and label the printout with the user name or machine
name. </P>

<P><A NAME="FileVirusesTestCleaningonYourBackupCopies"></A><B><FONT SIZE=+2>Test
Cleaning on Your Backup Copies</FONT></B></P>

<P>Can your product clean it? Testing cleaning is especially important
when it comes to file viruses. Most products are nearly adequate when it
comes to cleaning boot viruses (though most fail with things like Natas
and struggle with viruses such as Monkey, if these viruses are resident.)
But cleaning files requires more IQ, and is more perilous. After all, boot
sectors are a dime a dozen. Files aren't. </P>

<P>Take the diskette to a clean machine. Scan. If a virus is found, permit
it to clean. Now scan again. Is it still infected? Some products (e.g.,
CPAV) will stop before cleaning all files. Others may only remove a portion
of the virus code. </P>

<P>If it is no longer infected, are programs still usable? </P>

<P>Record file sizes. COM files should generally be the same size now as
corresponding uninfected COM files. EXE files should generally be no more
than 15 bytes larger. No program should be smaller after cleaning than
a copy that has never been infected. </P>

<P>Run each program. If any hang the machine or display garbage, your product
has likely damaged the file. </P>

<P>If cleaning is imperfect, and the virus is theoretically removable,
get a new product and repeat this test cleaning before proceeding. </P>

<P><A NAME="IfYourScannerClaimsitCanRemovetheVirus"></A><B><FONT SIZE=+2>If
Your Scanner Claims it Can Remove the Virus</FONT></B></P>

<P>Resist all temptation here and don't let the scanner remove it -- not
just yet. It's one thing to have an anti-virus product remove a virus and
leave you with a damaged file, and it's another for the scanner to remove
the virus and leave you with a program that runs. The difference between
the two is <U>perfect identification</U>. For a scanner to perfectly remove
a virus, it must know two things: exactly which virus this is and how to
remove this particular virus. Since most scanners don't do perfect identification,
you must do some experimenting: </P>

<UL>
<LI><FONT SIZE=-1>if the scanner can rename the file(s), let it</FONT>
</LI>

<LI><FONT SIZE=-1>if the scanner can't rename the file(s), copy down the
filename(s) and rename it manually</FONT> </LI>

<LI><FONT SIZE=-1>copy the renamed file to a floppy</FONT> </LI>

<LI><FONT SIZE=-1>let the scanner remove the virus from the copy on the
floppy</FONT> </LI>

<LI><FONT SIZE=-1>test the results:</FONT> </LI>

<UL>
<LI>is the file smaller than it was originally? If it is, the file is damaged.
You'll have to restore from a backup. But before you do, make sure that
the backup copy isn't infected, too. </LI>

<LI>does the file still run? If not, you'll have to restore from an uninfected
backup </LI>

<LI>does another scanner report a problem with this file? If the second
scanner finds part of the virus still in the program you tried to remove
the virus from, you'll be haunted until you replace from backups. Proper
removal won't leave any virus bytes in your cleaned file. </LI>

<LI>learn more about the virus. Look it up in V-Base -- it will describe
what the virus does, what it targets, how it infects, etc. </LI>
</UL>
</UL>

<P><A NAME="IfYourScannerClaimstheVirusisNotRemovable"></A><B><FONT SIZE=+2>If
Your Scanner Claims the Virus is Not Removable</FONT></B></P>

<P>If your scanner claims the virus isn't removable, it may be lying. But
it may not, so get out your labcoat and start experimenting: </P>

<UL>
<LI><FONT SIZE=-1>get another scanner and repeat the scan. Do this until
you find a scanner that can remove the virus. If you find one, go back
and read the previous section.</FONT> </LI>

<LI><FONT SIZE=-1>if you can't find another scanner that can remove this
virus, you'll have to delete the file and restore from an uninfected backup.
</FONT></LI>

<LI><FONT SIZE=-1>learn more about the virus in V-Base. Get clues on which
other files it might have infected and how. </FONT></LI>
</UL>

<P>If the infection is on your server, you may be tempted to down the server
right away. This will usually be counterproductive, since you won't be
able to do anything until it's back up. Here are some suggestions for what
to do: </P>

<UL>
<LI><FONT SIZE=-1>terminate all user connections from the server after
a warning, ensuring that users are able to close files that are open and
exit in an orderly way. </FONT></LI>

<LI><FONT SIZE=-1>run your best scanner against the server from a workstation,
letting it automatically rename all infected files it finds, and generating
a log file. You will need to login as Supervisor or Administrator to scan
everything. You might want to leave this product running non-stop, until
everything has calmed down. </FONT></LI>

<LI><FONT SIZE=-1>replace these infected files from your backup tape, and
scan again. Repeat using an older backup, if any restored files are infected.
If you cannot find uninfected backup copies, then use your anti-virus product
to remove the virus from the remaining infected (renamed) files. Be sure
to save one or two copies of the virus, for later analysis. </FONT></LI>

<LI><FONT SIZE=-1>modify the master login script so that all users will
have their local drives scanned when they login. This setup should ideally
generate a report for each user, which includes their login name. Someone
can review the reports to see which users are/were infected. </FONT></LI>

<LI><FONT SIZE=-1>check who has had permission to access the infected files.
One or more of these users is quite likely infected, if they ran any of
these files in the last few days. The infection may be in their workstation's
memory, ready to re-infect when they login again. Get down to their offices,
and get somebody busy checking their machine and all suspect floppies (any
disk that has been in their machine since the infection was introduced).
</FONT></LI>

<LI><FONT SIZE=-1>look up accurate information about this virus in an information
database such as <B>V-Base</B>. What you learn might be very helpful in
dealing with the virus or with concerned users and management. </FONT></LI>

<LI><FONT SIZE=-1>don't forget to notify your supervisor about the problem,
and to keep her posted. </FONT></LI>

<LI><FONT SIZE=-1>after all copies of the virus have been killed off, restructure
files on the server so that they cannot be infected. In some network operating
systems, you may be able to mark executables as &quot;execute&quot; or
&quot;execute only&quot;. In most, you can deny write permission at the
directory level to any directories housing executables. In NetWare, your
goal will be to not have any executable programs in any directory where
any user has write permission. </FONT></LI>

<LI><FONT SIZE=-1>if the infection resurfaces (most do), you may need to
install anti-virus TSRs or device drivers in local machines, and an anti-virus
NLM on each server. </FONT></LI>
</UL>

<P><A NAME="WhenYouareReadytoClean"></A><B><FONT SIZE=+2>When You are Ready
to Clean...</FONT></B></P>

<P><B><FONT SIZE=+1>If the machine can be safely scanned and the virus
safely removed while in memory...</FONT></B></P>

<UL>
<LI>Add your command-line scanner/remover to the network login script,
so that all users are scanned/cleaned when they login. Options to choose:
files that this virus can infect (if file infector), no memory scan. </LI>
</UL>

<P><B><FONT SIZE=+1>If the machine cannot be safely scanned with the virus
in memory...</FONT></B></P>

<UL>
<LI>Set login script to scan a non-existent file in root of C:, also scan
memory. Exit with errorlevel. If errorlevel then TYPE WARNING.DOC, PAUSE,
Warning should display message asking user to call you, and exit without
logging in. </LI>
</UL>

<UL>
<DT>The scanner must be stored in a directory in which no user (other than
supervisor) has write permission. </DT>
</UL>

<DT>
<HR WIDTH="100%"></DT>
</DL>

</BODY>
</HTML>
