
                             in name of zero

                       INOZ, issue #1, 20 nov. 2001


                 Переустанавливаем Windows за три минуты

                                         by Uzbeck aka NiFiGaSebe // UINC

  Очень  часто,  мои  друзья  ноют, что их система стала "грязной", и вот
 завтра  придется переустанавливать Windows. Каждый раз я им рассказывал,
 что  есть  более  элегантное решение, которое превратит установку в дело
 трех-пяти  минут,  а  тут еще на ХЗ форуме задали вопрос(цитирую):

  Тема: Восстановить первоначальное состояние Win98...
  Отправитель: Pingvin, April 25, 2001, 20:15:22:

  Подскажите  пожалуйста  как  мне восстановить основные параметры Win98,
 всмысле,   чтобы   винда   работала   так,   какбудто   её   только  что
 проинсталировали с диска?
  Я  просто  некоторые  драйвера  устанавливал,  после чего система стала
 работать  не  стабильно: до старта виндос сообщает об ошибках, проводник
 время-от времени накрывается... и.т.д.
  Там же Pingvin упомянул, что все стирать и переустанавливать систему не
 хочет только потому, что на диске лежит много ценного "добра".
  Была  предложена масса решений, но все они были какие-то извращенные. Я
 тоже  предложил, а вернее написал вот этот документ. Сразу хочу сказать,
 что  мой  способ  не  совсем решит проблему поставленную в сообщении, он
 скорее   поможет  избежать  таких  проблем  в  будущем.  Ссылки  на  все
 упомянутые ресурсы и программы будут указаны в самом низу.

  Часть 1
  Предлагаю  следующее  решение  (думаю  97% из прочитавших даже не знают
 того,  что я сейчас напишу). Решение заключается в переустановке системы
 как   только   она   становится  "грязной".  С  помощью  моего  решения,
 переустановка системы занимает максимум пять минут. Что нам понадобится:
  + Бумажка
  + Ручка
  + Windows StartUp Disk
  + Norton Symantec Ghost(или другой аналогичный софт для клонирования)
  + Windows Installation Disk(та самая версия, которую вы будете
  использовать)
  Прежде  всего, хотелось бы сказать, что работа будет намного облегчена,
 если  у вас на компьютере более одного диска(не важно, физически или как
 Partition).
  Если  это  не  так, но вы очень хотите сделать из одной partition сразу
 две  -  не отчаивайтесь, Partition Magic разделит на две без потребности
 стирать что-либо.
  Со  всем  ниже  перечисленным предполагается что у вас есть второй диск
 или еще одна Partition.
  Свою  версию Ghost мы устанавливаем и копируем главные файлы(ghost.exe,
 больше ничего не надобно вроде) на другой диск.
  Итак, берем бумажку и ручку. И выписываем:
  +  Все программы, которые должны стоять на свежей установке(то есть все
 то,  что  вы  используете  в повседневной жизни). Вместо бумажки и ручки
 можно  записывать  в  файл, это не принципиально(в конце я дам ссылку на
 пример моего списка).
  +  Все самое главное что нужно сконфигурировать и настроить(dat файлы с
 icq, настройка Dial-Up, итд).
  После  этого, стираем все с главного диска (диск С:, форматируем его) и
 начинаем  устанавливать  Windows  систему.  Устанавливаем  внимательно и
 аккуратно, конфигурируя на пути все что можно и нужно.
  После  установки  первым делом устанавливаем все необходимые для работы
 драйверы  (например,  для  меня это: Graphics Card, Sound Card, TV Card,
 Modem,  Printer  drivers, Digital Camera drivers), а затем устанавливаем
 патчи   и   обновления  (советую  накачать  все  самые  главные  патчи с
 микрософта и положить на второй диск\partition).
  Вот,   например,  список  всех  моих  обновлений  и  патчей,  которые я
 устанавливаю для Windows системы:
      [DirectX 8.0]
      [Flash&Shockwave]
      [IE Active Desktop Removal] - вот это не особенно нужно...
      [Java Runtime Environment] - чтоб Опера с Java plugin проблем не имела
      [Microsoft Installer] - чтобы можно было инсталлировать программы с .msi
      расширениями
      [ReplaceNsaKey] - это тоже не важно, кто знает, то поймет...
      [Win95]
      + [Euro Patch]
      + [IGMP Update]
      + [Service Pack 1]
      + [MS DialUp Networking Update v1.4]
      + [Winsock Update]
      + [y2k update]
      [Win98]
      + [IGMP Update]
      + [Service Pack 1]
      + [MS DialUp Networking Update v1.4]
      + [Win98 y2k Russian]
      + [Win98 y2k upd]
      + [Win98 y2k_2 upd]
      + [Year2k Outlook Express upd]
  После  всех  обновлений  -  перегружаемся, и смотрим - все ли нормально
 работает.
  Если да, то продолжаем:
  Теперь  устанавливаем все программы, которые были выписаны на листочек.
 Думаем и вспоминаем еще раз. (а вдруг забыли что-то?)
  Перегружаем   опять  и  конфигурируем  все  что  нужно.  Теперь  делаем
 Windows98  StartUp disk (заходим в мой компьютер -> панель управления ->
 установка  и  удаление  программ  ->  там  будет  Tab: Загрузочный диск.
 Вставляем  чистый  floppy  и  жмем -> Создать диск!) - почему именно 98?
 Да  потому,  что он простой и на нем есть драйверы для CD. Загружаемся с
 диска и загружаем тот самый Ghost, что вы положили на диск d:
  С  помощью  Ghost  делаем Дамп вашего partition, на котором установлена
 Windows.  Дамп  нужно делать на диск d: или другой, на котором не стояла
 система(на  диск,  дамп  которого  ты делаешь, записать сам дамп нельзя,
 по-моему  ясно почему). Как делать дамп partition'а, я объяснять не буду
 -  для  этого  есть  доки в Ghost, если этого не достаточно, то на сайте
 Bikkel  есть  доп.  доки.  Ссылку  на  кое-какие русские доки я тоже дам
 внизу. Загружаемся опять в Windows и работаем с системой.
  Как  только  система  стала  загрязненной  и  плохо  работает  -  опять
 загружаемся  в  DOS с дискетки и восстанавливаем с помощью того же Ghost
 вашу систему!

  Операция  восстановки обычной системы с перезагрузкой занимает у меня 4
 минуты(!). Надеюсь, разница во времени ясна.
  Заметки:
  1)  Дамп  можно  скопировать  на CD вместе с самим Ghost и делать все с
 самого CD.
  2) Образы(дампы) можно переносить с компьютера на компьютер, но во всех
 Windows  кроме  2000 всё hardware конфигурируется при установке, так что
 если машины не идентичные - восстановка системы не сработает.
  3)  Если  дамп  не  уместится  на  CD, то Ghost сможет разделить его на
 несколько  частей, чтоб уместился. Более того, Ghost сам умеет писать на
 CD.
  4)  Можно  установить  сервер,  и  при  наличии  сетевой  карты - можно
 восстанавливать системы через сетку!
  5)  При  клонировании  систем  на  основе  Win  NT  я  вам настоятельно
 рекомендую  изменять  SID(Security  IDentifier)  на каждой системе после
 восстановления  каждого образа в целях безопасности. Сделать это можно с
 помощью  программы  GhostWalker или других аналогов. Внизу будет указана
 ссылка на страничку с подробностями о важности уникального SID на каждой
 системе, а также, руководство по использованию GhostWalker.
  6)  Последняя  версия  Ghost  - 7.0(2001), достать ее сейчас сложно, ее
 только  выпустили,  а  вот  6.5  -  пожалуйста!  Работает  она  отлично!
 ВНИМАНИЕ:  на  текущий  момент  последняя  версия  Norton  Ghost - 2002.
 Однако,  версия  2002  мало  чем  отличается  от версии 2001 (в основном
 только  тем,  что  в  версии  2002  былы  добавлены несколько настроек и
 поддержка Windiws XP, Windows 2000 Logo Certified Workstation & Server).
  На всякий случай, описание самого Ghost(2001):
  Norton Ghost 2001 provides high-performance utilities for fast and safe
 system  upgrading,  backup,  and recovery. This new version works faster
 than  ever,  supports  the  Linux  EXT2  file system, writes disk images
 directly  to  many  popular CDR/RW drives, clones quickly from PC to PC,
 and  enables  Windows  XP,  Windows  2000 and Windows Millennium Edition
 users  to take advantage of its powerful tools. Designed for technically
 proficient  PC users, Norton Ghost 2001 is based on the industry-leading
 Symantec  Ghost  6.5  Enterprise Edition. So whether you want to back up
 your  existing  hard  drive or clone it to a new one, trust Norton Ghost
 for fast, safe PC cloning.
  Рассказывал вам это человек, который переустанавливает системы по 6 раз
 за день и больше.
  Лучшего  решения  чем  Ghost  для восстановления системы вы не найдете.
 Удачи


  Часть 2
  Итак,   после  прошлого  сообщения,  я  призадумался,  что  тему  можно
 продолжить.  Вот  некоторые  мысли  вслух...: Во-первых, стоит сказать о
 удаленном переносе дампов (например через сеть).
  Делается это несколькими способами:
  + Покупаем Ghost EnterPrise - там в поставке будет спец сервер, который
 поможет в решении проблемы.
  +  Если  денег нет, то ставим сервер(Windows, например 2000) на котором
 запущен  TFTP  сервис  с  логин скриптом, чтобы сразу в командную строку
 выбрасывало(если  при  загрузке  машины  было  выбрано  "загрузка  через
 сеть").  А  дальше  все  просто,  на  сервере  есть большой винчестер на
 котором  хранятся  разные дампы. Загружаешься на сервер и качаешь оттуда
 нужный дамп.
  + Забыл сказать, что последние версии Ghost также работают с принтерным
 и  USB  портами  -  подсоединяем  два  компьютера  через  LPT1 или USB и
 скачиваем\закачиваем образ.
  Во-вторых, забыл сказать, что Ghost еще отличается тем, что он умеет во
 время  создания  дампа  его сжимать, есть два уровня сжатия - средний(но
 быстрый) и высокий(но медленный). Полезная фича.
  В-третьих - не рекомендую использовать Ghost или другой адекватный софт
 из  вынь-засунь.  Всегда  пользуйтесь  только из DOS. Можно конечно и из
 вынь,  но  не  всегда  из  этого  получается  хороший  результат(в дампе
 получается своп с кучей дерьма).
  В-четвертых,  интересные доки по Ghost есть в online на сайте Bikkel. В
 том  же месте есть дока, о том, как сделать CD с дампом. Причем такой CD
 -   вставив   который   дамп   сам   устанавливается.   Достаточно  лишь
 перегрузиться  (при  условии что в БИОСе первое загрузочное устройство -
 CD).
  Вкратце объясню как это сделать:
  Берем  загрузочную  дискетку с DOS (например Windows 98 StartUp Disk) и
 копируем  все  с  нее  (вместе  с  загрузочным  сектором)  на CD. Правим
 немножко  autoexec.bat  (кое-какие  настройки  поменять  с  floppy на CD
 (например  -  куда  выскакивает при загрузке командная строка)), а также
 добавить пару линий в тот же autoexec, чтоб Ghost все начинал делать без
 вопросов.  Туда  же  на  CD  копируем  дамп  и сам Ghost.ехе. и все! При
 вставке  такого CD - компьютер загружается в DOS, autoexec.bat запускает
 Ghost и сообщает ему скопировать образ на винчестер без вопросов.
  Также,  на  домашней  страничке  Ghost у Symantec'а совсем недавно была
 выложена  серия  кратких  документов  по использованию Ghost. Вот список
 документов из этой серии:
  + How to clone a computer through a LAN connection
  + How to clone from computer to computer through a USB connection
  + How to create a clone and recover it from a CD-RW disk
  + How to add a new network interface card driver to the Boot Wizard
  + How to clone disk-to-disk on a single computer
  В-пятых,  я  забыл  сказать,  что  кроме  Ghost  есть другие программы,
 которые возможно и похуже, но дешевле(некоторые бесплатные).
  + ASR - программа весит 20кб, очень сложна в использовании и бесплатна.
 Лично  я не стал бы с ней возиться, но возможно кому-то будет охота, тем
 более, что я слышал много положительных комментариев о ней.
  +  Paragon  Drive  BackUp  -  включает в себя Imaging Solution, русская
 разработка,  правда shareware. Делает примерно тоже самое что Ghost, так
 что  обьяснять  не буду. Но вообще ребята с Paragon - редкие сдиральщики
 (в смысле денег).
  Естественно  все  эти  программы  понимают  не  только  FAT, но и NTFS.
 Последняя версия Ghost стала еще понимать Ext2FS(Linux) partition'ы.
  +  PowerQuest  Drive  Image  Pro  -  Очень  серьезный  конкурент Norton
 Ghost'а.  Умеет  почти  все тоже самое(если сравнивать НЕ с Norton Ghost
 Corporate  Edition).  Отличие лишь заключается в том, что Ghost работает
 из DOS(или DOS окна), а Drive Image Pro работает из Windows SafeMode.
  +  HDCOPY  -  Еще  одна  программа  для  клонирования. Поддерживает два
 способа  клонирования - Direct Copy (то есть система копируется с одного
 диска  сразу  на другой) и Image Copy (то есть создание и восстановление
 образа).
  В-шестых,  раз никто не стал более умным, чтобы рассказать мне о других
 более крутых решениях проблемы, то я расскажу о классическом случае а ля
 самом крутом, который я когда-либо видел.
  Начну  свою  историю  с  введения:  есть  в  Англии  такая компьютерная
 компания,  называется  RM(Research  Machines).  Чем  они занимаются? Они
 поставляют  компьютеры  для  почти  ВСЕХ(!) школ в Англии(естественно по
 очень  дешевой цене). Кроме сборки своих компьютеров(очень даже неплохие
 штучки)  они  еще и кое-какой софт делают, что-то типа Новелла, но круче
 по некоторым параметрам!
  При загрузке компьютера появляется их собственный Login Screen, который
 и  вводит  компьютер  в  школьную  сетку.  Но  особенность заключается в
 другом,  а  именно в том, что при загрузке каждый раз(!) устанавливается
 "чистая"  система.  Загрузка  занимает  на  полминуты больше чем обычная
 загрузка   стандартных   вынь-засунь   98(и   это  при  том,  что  кроме
 восстановления,  происходит  проверка  антивирусом  в  DOS).  Как же это
 происходит?  RM  придумали  решение  повеселее,  чем копирование дампов!
 Просто  при загрузке, все файлы сканируются автоматом на диске, делается
 репорт  который  сравнивается  с  тем,  который  лежит  на сервере. Если
 каких-то  файлов  не  хватает,  то  они  подгружаются,  если  лишние, то
 удаляются.  Я  не  буду  описывать более мелкие детали (например то, что
 если  заменить файл на другой файл с таким же именем и таким же размером
 то   его  система  не  заменит),  но  все-таки  система  очень  и  очень
 прикольная.  То  есть ни о каком распространении троянов по школе и речи
 быть  не  может! Если ты установил троян, то действовать он будет только
 до перезагрузки!
  Из  этого  можно сделать вывод - если бы такие системы были и в россии,
 то  98%  тех  школьников,  которые  считают  себя кул-хацкерами сразу бы
 наделали  в  штаны,  перестали  использовать  трояшки  и  делали бы дом.
 задание.  Второй  вывод,  который  можно  сделать, это то, что навредить
 можно  только  если  ты знаешь пароль от БИОСа (но ведь это не проблема,
 правда?),   загружаешься  в  него,  меняешь  местами  носители  загрузки
 (проставляешь  floppy,  он  по умолчанию не проставлен) и загружаешься с
 floppy  чтобы  стереть MBR или еще что-то типа того. Таким образом можно
 поломать  за  один раз ТОЛЬКО один компьютер, что не очень эффективно, и
 восстановить  такую  систему  проблем  не  составит(только вcтавить спец
 floppy, который поставляется с RM софтом и нажать пару кнопок).
  В  общем,  у  системы есть много преимуществ и недостатков(которых явно
 меньше).  Другие  особенности  софта  описывать  не буду потому что не в
 тему,  а  вот  про  то,  как  работает  серверное ПО по восстановлению -
 поясню:  На  сервере хранится специальная версия Windows, которая служит
 мастером   -   все  workstation'ы  ориентируются  на  эту  копию.  Чтобы
 модифицировать  эту  копию, достаточно лишь зайти под спец логином(вроде
 Propagate,  забыл,  не  помню)  и  паролем(строжайший  секрет)  с  любой
 воркстейшен. Вам будет дан полный доступ ко всем настройкам плюс в старт
 меню  будет  пара админских прог. Вы устанавливаете и конфигурируете все
 как  нужно  и  в одной из админских прог жмете спасти и делаете logout -
 все! система сохраняется на сервер, и новая копия создана.
  Вот  такая  вот  система  есть, неплохо бы было ее во все русские школы
 установить, чтоб побольше народу серьезные книжки читало...

  Примечания
  Вся это возня с дампами является самым лучшим и быстрым решением ТОЛЬКО
 в  том  случае,  если  вы  собираетесь  переустанавливать систему больше
 одного  раза  в  пол-года.  Вот  кстати списочек тех людей, которым явно
 пригодится описанное решение:
  + Системный администратор
  + Продвинутый пользователь
  + Вирусописатель\Писатель троянов\Троянщик
  + Софт тестер
  + Варезник
  +  Кул  хацкер(это  те,  которые  кликают  на  все  exe файлы подряд, и
 появляется много троянов - легче переустановить чем искать его). Если же
 систему  вы  переустанавливаете  с периодичностью - раз в год, то лучшим
 ответом  на  вопрос  в самом начале будет: Сделать backup ценных данных,
 форматнуть  винт  и  переустановить  систему. Заодно по пути, сделать из
 одного  partition'а - два, и хранить на c: только установленное ПО, а на
 d:  все  свое ценное барахло, а дальше форматируй сколько влезет, данные
 останутся на d:.
  Единственным  другим  решением,  которое  ответило  хотя  бы  как-то на
 вопрос, является то, что сказал Заключенный(цитирую):
  Классная  вещь System Restore в Windows Me - восстанавливает систему, а
 так же есть отмена установки - если ты ставил Мелениум поверх 98 или др,
 так что возникает еще один совет:
  Можно  поставить  винду 95 или 98 и все необходимое ПО(которое ты точно
 будешь  юзать) затем поставить поверх Милениум и все, как только система
 будет  глючить  полностью(в смысле даже System Restore не спасает) можно
 отменить  установку  Милениума  и  у  тебя  останется чистый 95 или 98 в
 зависимости от того что ты ставил).
  И мой комментарий по этому поводу:
  1)  Извращенный  способ.  Более  того,  все эти откатки назад глючат. А
 когда нужна чистая система, это значит не только чистые драйверы.
  2)  Да  и откат назад займет намного больше времени чем переустановка с
 помощью Ghost.

  Дополнения
  13.05.01  - На сайте "Сетевые заметки", я наткнулся на очень интересную
 информацию по теме(цитирую):
  Вы замучили Windows (до потери загружабельности) бесконечной установкой
 всяко-разных  твикеров,  бустеров,  разгонщиков  и  прочего  утиля и она
 выдает Вам одну глюкву.
  А переставлять вЫнь и все проги совсем не хочется...
  Не вопрос! Есть одно элегантное решение:
  Экспортируем    все    ключи   из   реестра,   ветви:   HKLM\Software и
 HKCU\Software.  Теперь  заходим в С:\Windows (или где она там) и убиваем
 файлы  с  расширением  *.dat  (это  как  правило system.dat и user.dat).
 Переносим из корня диска (как правило С:\) в C:\Windows файл system.1st.
 Переименовав  его  в system.dat! Теперь перезагружаемся.., что мы имеем?
 Вуаля  -  последний этап установки виндов(!) - идет поиск оборудования и
 настройка главного меню...
  Система  становится  девственно  чистой,  как слеза дитятки. По желанию
 восстанавливаем  сохранненные  ключи  в  реестр,  чтобы  не переставлять
 заново проги. Вот так - 10 минут и у Вас прежние окна, ...только вымытые
 ;). Мой комментарий: я не проверял этот способ, поэтому не могу сказать,
 возможно  ли  такое  сделать.  Если  возможно  то  это становится лучшим
 решением  для  заданного  вопроса  в  самом начале, но лучшим глобальным
 решением все-таки остается метод с образами - это быстро и не приходится
 запутываться в операциях(нажимать пару кнопок несравенно легче и быстрее
 чем  экспортировать  ключи  и переименовывать файлы). Еще одним ОГРОМНЫМ
 недостатком  вышеуказанного  метода  с  работой реестра является то, что
 чистится только сам реестр(то есть только улучшается работа системы), но
 сама  система  не чистится от ненужных вам программ, файлов и временного
 "мусора"(Temporary Files).
  05.10.01  - Мне приходило много писем с рассказами о том, какой хороший
 способ  -  скопировать  папки  Windows  и Program Files, заархивировать,
 отформатировать диск и восстановить папки занова. Я очень плохо отношусь
 к  таким способам, ведь оба из этих каталогов тоже загрязняются, так что
 чистую  систему  таким  способом  не  сделать. Однако, для упрямых, есть
 программка-помощница,  которая  называется  LN  1.11.  Цитирую описание:
 Утилита  для  сохранения  -  восстановления  в файл длинных имен Win'95,
 например перед архивацией, удобно использовать вместе с Дос Навигатором,
 который  вместе  с LN можно настроить так, что будут видны длинные имена
 (9К).
  То  есть,  вы  сохраняете  длинные  имена  в файл, потом из чистого DOS
 копируете  вышеуказанные  папки  и архивируете их. После формата диска с
 помощью  этой  программы  и  файла  со  списком  длинных  имен можно все
 восстановить  или  перенести  на  другую систему. Естественно, запускать
 такую программу нужно из Dos box в Win9x.
  12.10.01  -  Опять  пришло море писем от читателей с замечаниями. Как я
 узнал  от  Alexander  Sheiko,  у  Norton Ghost версий 2000 и 2001(только
 6.5)   были   достаточно  серьезные  глюки,  которые  сильно  заставляли
 задумываться  о смене программы для клонирования. Первый глюк заключался
 в  невозможности  записи на NTFS системы, прочитать об этом можно здесь,
 также,  другая  проблемма  состояла  в  том, что было невозможно выбрать
 никакой диск кроме дискетки, об этом написано здесь. Эти и многие другие
 проблеммы   были   исправлены  в  версиях  2001(7.0)  и  2002,  так  что
 аналогичных  проблемм вроде не должно возникнуть. От себя могу добавить,
 что еще Ghost не умел работать с новой версией NTFS которая используется
 в Windows XP. Данная проблемма была решена в версии 2002.
  Вот  еще  один  из комментариев, котроые я получил от Alexander Sheiko:
 Обычно  те,  кто  начинал  с госта (в т.ч. и я) со временем переходят на
 Drive  Image.  За  последней  не  наблюдается  глюков  да  и сделана она
 удобней.. Еще несколько очень похожих комментариев я получил и от других
 людей.  Да,  похоже придется согласиться - Drive Image все-таки наверное
 имеет меньше глюков(хотя стоит заметить, что за все время работы с Ghost
 версий  2001(7.0)  и  2002 у меня не было ни одного глюка), да и удобнее
 он,  но  все-таки  как  корпоративное  решение,  лучше Ghost пожалуй нет
 ничего. Чем же еще Drive Image лучше Ghost'а?
  Процитирую часть письма от Vladimir:
  Кроме,  давно  оцененного  многими(Partition  Magic  и  т.д.), качества
 продуктов PQ, DriveImage4 обладает следующими свойствами:
  1) Несколько уровней компрессии.
  2) Разбитие на тома.
  3) Защита паролем.
  4)  Smart  режим  (неиспользуемые  сектора\кластеры файловой системы не
 попадают в образ).
  5)  Образ не содержит тела файла подкачки Windows, что сильно уменьшает
 размер образа. Но после восстановления файл оказывается на своём месте.
  Эти свойством обладают только последние версии.
  6)  Проверка файловых систем от DOS16 до NTFS (Unix системы не паковал,
 так, что про них, ничего не говорю).
  7) Возможность хранения в одном файле образа несколько разделов.
  8)  Windows  GUI  утилиты  пакета  позволяют  осуществлять  навигацию в
 файловой  системе  образа.  Правда  проблемы  с  русским  языком, но всё
 работает корректно.
  9)  Автоматическое(после  нескольких  вопросов)  адаптирование образа к
 разделу с отличяющимся размером.
  10) Простота для пользователя - все утилиты PQ имеют единый интерфейс.
  11)  Надёжность - за все годы PQ утилиты мне не разу не напакостили. Из
 всех  вышеперечисленных  свойств,  в  Ghost  отсутствуют  пункты  4 и 5.
 Также,  под  сомнение  ставится  пункт  10,  так  как я не уверен насчет
 простоты Ghost - для меня он прост, а возможно для других он невыносим.

  Насчет  способа описанного в дополнении от 13.05.01 - товарищ, по имени
 Chiper_2000  охотно  поделился  своими  впечатлениями после тестирования
 данного способа:
  За  время,  прошедшее со времени прочтения статьи до твоего ответа этим
 способом я восстановил 2 компа за ~20 мин каждый. Стоит правда заметить,
 что  еще  на  одном  винду я все таки убил, но после переустановки винды
 импортировав  вот эти самые две ветки реестра я восстановил 95% софта; к
 5%  относилось  нечто  мультимедийное,  что  и  являлось причиной сбоев.
 Метод-то,  оказывается  вполне стоящий, а теперь вырисовывается еще один
 ответ на поставленный в начале статьи вопрос. Метод следующий:
  1)  С  помощью  любой  утилиты,  которая  умеет  отслеживать DLL файлы,
 которые  не использует система, удаляем все ненужные DLL. Например можно
 использовать программу Clean System Directory(CleanSys, весом 30кб).
  2)   (НЕ   обязательно)  -  заменяем  все  системно-важные  DLL  на  их
 первоначальные   оригинальные   версии,  которые  были  скопированы  при
 установке.  Для  извлечения  оригинальных  версий DLL из дистрибутивного
 диска  можно  использовать программу Sfc.exe, которая может быть вызвана
 из "Сведений о системе". (thanx 2: Chiper_2000)
  3)  Чистим  систему  от  того, что можно почистить(это, например, такие
 папки как \Windows\Temp и \Windows\Temporary Internet Files).
  4) Делаем то что описано в методе от 13.05.01.
  5)  Архивируем  все  файлы  и  форматируем диск, то есть делаем то, что
 описано в методе от 05.10.01.
