
                 ╔═══════════════════════════════════════════╗
                 ║ ■                                       ■ ║
                 ║      █▀ █▀▄ █▀ █▀█ ▀█▀ █ █ █▀▄ █▀ █▀▀     ║
                 ║  THE █  █▄▀ █▄ █▄█  █  █ █ █▄▀ █▄ █▄▄     ║
                 ║      █▄ █ █ █▄ █ █  █  █▄█ █ █ █▄ ▄▄█     ║
                 ║ ■                                       ■ ║
                 ╚═══════════════════════════════════════════╝

                                    ENUNS

-------------------------------------------------------------------------------

ТАМАДА:
        Оказывается, не все еще сказано про заражение COM-файлов! И все
 благодаря известнейшей по всему миру компании Microsoft и иже с ним.
  [бурные аплодисменты]
  
ТАМАДА:
        Я говорю о том, что эти сволочи опять маятся полной х... ну, ерундой
 вообще, на этот раз с COM-файлами из комплекта Windows'95
  [смех в зале]

ТАМАДА:
        Дело в том, что если их заражать стандартно, то ничего не выйдет.
  [зал сконфужен. слышится крик "пить меньше надо". тамада вспотел]

ТАМАДА:
        Эти программы (скажем %winbootdir%\COMMAND\*.com) имеют в своем теле
 страшную строку ENUNS, после которой идет длина файла в байтах. Если заразить
 такой файл, то в лучшем случае при запуске произойдет выход.
  [бурные аплодисменты]

ГОСТЬ N1:
        Не понятно, на хуя они это сделали, ведь это хуйня полная, на хуй, и
 хуй бы они что добились таким хуемудоебством, пиздобратия сраная, ведь, бля,
 единственно, что надо сделать, на хуй, это заменить в пизду эти ебаные байты,
 тем более, их два всего, блядь на хуй.
  [смех в зале]

ГОСТЬ N2 (лет 50, еврей по виду):
        Молодой человек! Некультурно так выражаться при дамах. К тому же ENUNS
 имеет немаловажный header байт эдак на тридцать...
  [бурные аплодисменты]

ГОСТЬ N1 (перебивая):
        НУ И ХУЙ! Все равно этот хэдер ни хуя не играет, и сосали бы они...
  [смех в зале]
  
ГОСТЬ N2 (строго, поучительно):
        Откуда вы знаете!?
         (про себя):
        ...сколько лет лечу, уж мне-то не знать...
  [зал молчит]

ГОСТЬ N1:
        Как откуда? Так работает ведь все, и это главное.
        Практика - критерий истины. Блядь на хуй.
  [отдельные смешки]

ГОСТЬ N2(возмущенно):
        Как? Так вы один из тех компьютерных вандалов! И я с ним за одним
 столом... Не потерплю!
       (лезет в драку. Секьюрити в дверях напряглись. Зал в экстазе.)

ГОСТЬ N1(беря со стола чугунок с кипятком):
        Да имел я вас всех!
       (встает, пошатывается и роняет чугунок в зал. Чугунок летит...
        В зале шок. Потом раздаются крики)

ТАМАДА:
        Ну, спокойней, спокойней ребята...
       (может, он и хотел сказать что-то еще, не попади в него
        пятилитровая бутыль с самогоном)

КТО-ТО ИЗ ЗАЛА:
        Э! Самогон разольешь, мудило!
       (тамада молчит)

ГОСТЬ N1:
        Да и вобще там делать не' хуя....

        далее идут неразборчивые реплики, но по интонации ясно, что
        спор далеко не кончился. Слышится звон разбитого стекла, ругань...
        Гость N1 скрылся из виду, тут прибегают менты.........и пиздец.


   а теперь о том, что же это все значит:


                        ЗАРАЖЕНИЕ COM.ENUNS-файлов

        Действительно, com-файлы 95х виндов имеют все вышеперечисленное и
 нижеупомянутое, но к делу это не относится, суть в том, что они и в самом
 деле не работают, будучи заражены стандартно. Однако дело обстоит не так
 страшно, я бы даже сказал, весьма пиздато, потому как "на хуй они это 
 сделали" действительно непонятно. Что же из себя представляет ENUNS? Важно
 лишь то, что у него последние семь байтов - ENUNSxy, где xy - длина (word)
 файла. Поэтому чтобы поиметь такое убожетсво, достаточно считать эти
 байты (можно все семь):
                        sub cx, cx
                        mov dx, -7
                        dec cx                  ; (cx:dx= -7 в
                        mov ax, 4202h           ; дополнительном коде)
                        int 21h                 ; переместим pointer

                        mov cx, 7
                        mov ah, 3Fh
			lea dx, [ENUNS+bp]; или что там у вас...
			int 21h			; прочитаем 7 байт

                        add word ptr [ENUNS+bp+5], (end-start)

        И все! Теперь ваш файл готов к записи. В конечном итоге файл будет
 выглядеть так:

 [jmp ... ]
 [носитель]
 [старый ENUNS] - можно затереть это значение, тем хуже для av
 [основная часть]
 [новый ENUNS] - IMPORTANT! Новое значение приписывается в самый конец файла!

        Надеюсь, идея ясна, хотя что тут может быть неясного...
 Но спешу предупедить (т.е. обломить): В 98-х виндузах появилась
                             !НОВАЯ ХРЕНЬ!
 Называется RUSNS. (это типа адаптации enuns'а для русских :)
 Что это за чудо-юдо, пока не знаю. Но, думаю, оно не особо мощное. 
 Так что - вперед! Проведите небольшое исследование, это поможет вам 
 в дальнейшей работе.
        Если кто владеет подробной информацией насчет RUSNS, просьба написать
 на ThePretender@mail.ru

                                                        /Джарод

                                                  Информация предоставлена
                                                  by Techno Phunk/TI

                                                  have fun!