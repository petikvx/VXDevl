<html>

<!-- Mirrored from vx.netlux.org/texts/html/fat32new.html by HTTrack Website Copier/3.x [XR&CO'2003], Wed, 02 Jul 2003 18:11:12 GMT -->
<head>
<title>FAT32, New Problems for Viruses or Anti-Virus?</title>
</head>
<body text=#000000 bgcolor=#ffffff>
<h2>FAT32, New Problems for Viruses or Anti-Virus?</h2>

<table border="0" cellspacing="1" width="90%">
    <tr>
        <td width="100%">
        <p align="center"><strong>Martin G. Overton</strong></p>
        <p align="center">Virus Researcher
        and Author of ChekMate.</i></strong></p>
        <p align="center"><strong>Email: ChekWARE@Cavalry.com</strong></p>
        <p align="center"><strong>Tel: +44 (0) 1403 241376<br>
        +44 (0) 1403 232937</strong></p>
        <p align="center"><strong>51 Cook Road,<br>
        Horsham, West Sussex,<br>
        RH12 5GJ, United Kingdom.</strong></p>
        </td>
    </tr>
    <tr>
        <td width="100%">The sudden appearance of FAT32 in service pack 2
        for Windows '95 has brought some new complications for
        both viruses and anti-virus software. What's worse is the
        update is only available to OEMs to ship on new PCs. It's
        been dubbed Windows '96-and-a-half, as it is just a short
        stop from Windows '97 (<i>now finally called Windows
        &#146;98</i>).</p>
        <p>What are the implications of
        Microsoft's latest addition to the file system format
        jungle?</p>
        <p>Can the existing anti-virus software
        handle FAT32?</p>
        <p>Can the existing boot and partition
        sector viruses infect FAT32 successfully, and without
        making the system unbootable or unusable?</p>
        <p>Will file-infecting viruses be
        affected?</p>
        <p>This paper aims to deflate the myths,
        clarify the differences and report the results of testing
        the above scenarios.</p>
        <hr>
        <p align="center">This paper was written
        for, and presented at the 1997 Virus Bulletin conference <br>
        at San Francisco,USA on October 2nd-3rd 1997.</i></p>
        <p align="center">I would welcome any
        suggestions for improvement, comments on this paper and
        it&#146;s content.</i></p>
        <p align="center">This paper will be updated
        from time to time.</i></p>
        <p align="center">(Martin Overton 8th
        October 1997)</i></b></p>
        <hr>
        </td>
    </tr>
    <tr>
        <td width="100%"><b></b><p><b>Introduction</b></p>
        <p>Although this is intended as a
        technical paper, where possible full and detailed
        explanations will be given so that any laypersons that
        may be reading this (<i>hopefully</i>) won&#146;t be too
        confused. Anyone with a reasonably technical or support
        background will find the main content of this paper
        understandable and maybe a little too basic. The virus
        specific information and test results will be explained
        as clearly as possible within limited technical
        parameters of virus nomenclature and related jargon.</p>
        <p>As I began to research this paper I was
        astonished by the lack of testing of Windows 95 with live
        viruses running under 95. There are plenty of papers and
        reviews testing Windows 95 scanners against a test set of
        viruses, but not when active in memory, only as dormant,
        inanimate images. Only two other papers were found that
        tested Windows 95 with viruses allowed to go resident and
        infect the system, and these used a very small set of
        viruses for testing.</p>
        <p>Before jumping straight into the
        technical results, lets set the scene, as you may not
        know about the service releases of Windows &#146;95 and
        what these bring to the table. So here goes, a potted
        history...</p>
        </td>
    </tr>
    <tr>
        <td width="100%"><b></b><p><b>What is 95B and OSR 2.x?</b></p>
        <p>Whenever a new operating system is
        released, inevitably some user somewhere finds a problem,
        which needs to be fixed. Rather than release a complete
        new version of the operating system, software providers
        fix errors through <i>&#145;service releases&#146;</i>
        also known as <i>&#145;service packs</i>&#146;.</p>
        <p>Service pack 1, released in January
        1996 brought Windows 95 (<i>4.00.950</i>) up to version
        95A (<i>4.00.950a</i>). Service pack 2 brings Windows 95
        up to 95B (<i>4.00.1111</i>), released to OEMs in August
        &#146;96, this is not being made generally available. It
        cannot (<i>legally</i>) be used to upgrade existing
        machines, it can however be purchased with a new Hard
        Drive or Motherboard. It is mostly only being
        pre-installed on new PCs, although some parts of OSR2 can
        be downloaded from Microsoft&#146;s web site for free. (<i>http://www.microsoft.com</i>)</p>
        <p>Toshiba, Dell, Compaq and IBM are
        already pre-installing 95B on new PCs, many other
        manufacturers and resellers are planning to ship 95B on
        forthcoming models.</p>
        <p>Windows 95 OSR2 is a service release (<i>service
        release 2</i>) of Windows 95. It includes all of Service
        Pack 1, and all of the later patches and fixes currently
        available on the Microsoft Web site, as well as Internet
        Explorer 3 and Personal Web Server. It also includes
        several components currently not available for download,
        including a new file system, FAT32. Other bugs, which
        were present in earlier releases of Windows 95, are fixed in OSR2. Though some
        users complain that other things were broken, c&#146;est
        la vie!</p>
        </td>
    </tr>
    <tr>
        <td><b></b><p><b>What is FAT32?</b></p>
        <p>Versions of Windows 95 older than OSR2
        (<i>95 and 95A</i>), as well as many DOS versions, use a
        file system called FAT16 (<i>or FAT12 with DOS 3.30 or
        earlier versions</i>). The existence of large hard drives
        has led to large partition sizes, which mean large
        cluster sizes and wasted space.</p>
        <p>To clarify this: Imagine a file that is
        600 bytes (<i>characters</i>) in size. On a 1GB FAT16
        partition this file would take up not 600 bytes but <i>16KB
        (16,384 characters, 1KB =1,024 Characters or
        &#145;Bytes&#146;</i>), wasting over 15KB. On a 1GB FAT32
        drive the same file would take up 4KB of space, wasting a
        lot less space. Below is a table that shows the cluster
        size used by different sized drives under FAT16 &amp;
        FAT32.</p>
        <div align="center"><center><table border="1" cellspacing="1" width="529">
            <tr>
                <td valign=top width="25%" ><p align="center"><b>Partition Size
                (FAT16)</b></p>
                </td>
                <td valign=top width="25%" ><p align="center"><b>Cluster Size</b></p>
                </td>
                <td valign=top width="25%" ><p align="center"><b>Partition Size
                (FAT32)</b></p>
                </td>
                <td valign=top width="25%" ><p align="center"><b>Cluster Size</b></p>
                </td>
            </tr>
            <tr>
                <td valign=top width="25%">Up to
                128Mb</td>
                <td valign=top width="25%"><p align="center">
                </td>
                <td valign=top width="25%">Less
                than 260MB</td>
                <td valign=top width="25%"><p align="center">
                </td>
            </tr>
            <tr>
                <td valign=top width="25%">Up to
                256Mb</td>
                <td valign=top width="25%"><p align="center">
                </td>
                <td valign=top width="25%">260MB
                to 2GB</td>
                <td valign=top width="25%"><p align="center">
                </td>
            </tr>
            <tr>
                <td valign=top width="25%">Up to
                512Mb</td>
                <td valign=top width="25%"><p align="center">
                </td>
                <td valign=top width="25%">
                <td valign=top width="25%"><p align="center">
                </td>
            </tr>
            <tr>
                <td valign=top width="25%">Up to
                1Gb</td>
                <td valign=top width="25%"><p align="center">
                </td>
                <td valign=top width="25%">
                <td valign=top width="25%"><p align="center">
                </td>
            </tr>
            <tr>
                <td valign=top width="25%">Up to
                2Gb</td>
                <td valign=top width="25%"><p align="center">
                </td>
                <td valign=top width="25%">Greater
                than 32Gb</td>
                <td valign=top width="25%"><p align="center">
                </td>
            </tr>
        </table>
        </center></div></td>
    </tr>
    <tr>
        <td><p>Although by
        default, FAT32 will be used on drives over 512MB, it can
        be forced, though this is not recommended by Microsoft,
        to work on drives of any size less than 512MB.</p>
        <p>To do this you can use <i>FDISK </i>with
        the<i> /FPRMT</i> switch to enable large disk support (<i>FAT32</i>)
        on drives smaller than 512MB. Not for non-expert users
        and don&#146;t expect Microsoft to bail you out it you
        experience problems. There is also a way to specify the
        cluster size when the drive is formatted, (<i>FORMAT /z:n</i>)
        <i>n* 512 bytes=cluster size</i>, e.g. <i>FORMAT C: /z:2</i>
        would format the C: drive with 1KB clusters. Be warned
        though, Microsoft will not support cluster sizes of less
        than 4KB.</p>
        <p>FAT32 supports large drives and
        partitions (<i>up to 2TB (Terabytes)</i>) whereas FAT16
        only supports up to 2GB (<i>Gigabytes</i>). Unfortunately
        FAT32 formatted drives cannot currently be read or
        written to by NT, DOS or OS/2 and therefore this is seen
        as a major headache by support staff. Some major PC
        manufacturers have taken the stance that installing FAT32
        on their system would invalidate the warranty.</p>
        <p>If you use FAT32 then you can no longer
        boot to the previous version of DOS as you could with
        95A. You can use third-party boot managers, such as: OS/2
        boot manager, NT boot manager, etc. As long as you
        don&#146;t use FAT32 you will still be able to read and
        write to the Windows 95B drive from other operating
        systems.</p>
        <p>Other file system improvements include:
        FAT mirroring, backup of critical areas (<i>such as the
        DBR</i>), relocatable root directory and dynamic resizing
        of FAT32 partitions.</p>
        </td>
    </tr>
    <tr>
        <td><b><i></i></b><p><b><i>How Do I Tell If I&#146;ve Got 95B
        (OSR2.x)?</i></b></p>
        <p>Typing &#145;<i>VER</i>&#145; at a DOS
        prompt inside Windows 95 produces the following version
        number information:</p>
        <blockquote>
            <blockquote>
                <p><b>95 release version:</b> Windows 95. [Version
                4.00.950]</b></p>
                <p><b>DOS Version:</b> 
                <p><b>95A (OSR1): </b>Windows 95. [Version
                4.00.950]</b></p>
                <p><b>DOS Version:</b> 
                <p><b>95B (OSR2)</b>: Windows 95. [Version
                4.00.1111]</b></p>
                <p><b>DOS Version</b>: 
            </blockquote>
        </blockquote>
        </td>
    </tr>
    <tr>
        <td><b><i></i></b><p><b><i>How Do I Tell If I&#146;m Running
        FAT32 On My Drive(s)?</i></b></p>
        <p align="left">Simply double-click on the
        &#145;My Computer&#146; icon on the desktop, and then
        right-click on the relevant drive icon and selecting
        &#145;Properties&#146; will show the following dialogue
        box</p>
        <p>The Type entry clearly shows that this
        local disk is FAT32, not FAT16 or FAT12.</p>
        <p>If you use FDISK to create a partition
        of greater than 512MB and you enable large disk support,
        then the drive will be set to FAT32 by default.</p>
        <p>Drives smaller than 512MB or disabling
        &#145;large disk support&#146; will ensure that FAT16 is
        used instead.</p>
        <p>Running FDISK on a drive larger than
        512MB will display the following message if you have
        OSR2.x installed.</p>
        <div align="center"><center><table border="1" cellpadding="7" cellspacing="1">
            <tr>
                <td>Your
                computer has a disk larger than 512 MB. This
                version of Windows<br>
                includes improved support for large disks,
                resulting in more efficient<br>
                use of disk space on large drives, and allowing
                disks over 2 GB to be<br>
                formatted as a single drive.<br>
                <br>
                IMPORTANT: If you enable large disk support and
                create any new drives on this<br>
                disk, you will not be able to access the new
                drive(s) using other operating<br>
                systems, including some versions of Windows 95
                and Windows NT, as well as<br>
                earlier versions of Windows and MS-DOS. In
                addition, disk utilites that<br>
                were not designed explicitly for the FAT32 file
                system will not be able<br>
                to work with this disk. If you need to access
                this disk with other operating<br>
                systems or older disk utilities, do not enable
                large drive support.<br>
                <br>
                Do you wish to enable large disk support
                (Y/N)...........? [N]</td>
            </tr>
        </table>
        </center></div><p>FDISK can also be used
        to check to see if your current drive(s) are formatted as
        FAT12, FAT16 or FAT32. Selecting option 4 from the menu
        when FDISK is run shows the following:</p>
        <div align="center"><center><table border="1" cellpadding="7" cellspacing="1">
            <tr>
                <td>Display
                Partition Information<p>Current fixed disk drive: 1</p>
                <p>Partition
                Status Type Volume Label Mbytes System Usage</p>
                <p>C: 1 A PRI
                DOS FAT32_C2 1028 FAT32 50%</p>
                <p>2 EXT DOS
                1020 50%</p>
                <p>Total disk
                space is 2047 Mbytes (1 Mbyte = 1048576 bytes)</p>
                <p>The Extended
                DOS Partition contains Logical DOS Drives.</p>
                <p>Do you want
                to display the logical drive information
                (Y/N)......?[Y]</p>
                <p>Press Esc to
                return to FDISK Options</p>
                </td>
            </tr>
        </table>
        </center></div></td>
    </tr>
    <tr>
        <td><b></b><p><b>Why all this fuss?</b></p>
        <p>It seems that Microsoft have once again
        caused a large amount of confusion regarding it&#146;s
        new file system. We only have to look back at the
        confusion of the average user when HPFS and NTFS were
        released. Even now many users believe that viruses cannot
        infect under these file systems. As stated in the 1996
        Virus Bulletin conference &quot;<i>Although Windows NT
        was designed as a secure operating system, this security
        does not include viruses</i>&quot;<sup>[Jones]</sup>.
        This shows that with NT and NTFS that many viruses work
        fine, others such as macro viruses are hardly
        inconvenienced unless they try to use API&#146;s or OS
        specific functions.</p>
        <p>Regular lurkers in the Alt.Comp.Virus
        newsgroup will remember the flurry of posts and threads
        regarding a certain anti-virus program being criticised
        for not supporting FAT32. Many came to their defence,
        such as Vesselin Bontchev, Jimmy Kuo and the incumbent
        Virus Bulletin editor, Nick Fitzgerald (<i>though at the
        time he was the Comp.Virus &amp; Virus-L moderator and
        FAQ maintainer</i>).</p>
        <p>Later in this paper I will cover the
        &#145;myths&#146; some of which were being offered as
        fact by well-intentioned participants of this newsgroup.</p>
        </td>
    </tr>
    <tr>
        <td><b></b><p><b>Myth #1?</b></p>
        <p><i>Windows 95 is so different that
        viruses cannot infect it.</i></p>
        <p>Of course in reality, very few people
        now believe this, though this appears to have been one of
        the common &#145;urban myths&#146; about Windows 95 and
        it&#146;s near magical protection<sup>[Whalley]</sup>.
        The reason for the myth is understandable as
        Microsoft&#146;s own marketroids, insisted that Windows
        95 was &#145;<i>All New&#146;</i>.</p>
        <p>It is perfectly clear that although
        Windows 95 brings some new challenges to the virus
        writer, many DOS viruses (<i>including MBR and DBR
        viruses</i>) work adequately under Windows 95 and FAT32.
        In fact macro viruses are the group of viruses least
        troubled and inconvenienced by FAT32. Only those that use
        API&#146;s and other operating system specific calls are
        likely to fail.</p>
        <p>Microsoft&#146;s claim that Windows 95
        was &#145;<i>All New&#146;</i> was to say the least
        misleading. Bearing in mind that Microsoft tried
        extremely hard to support the vast majority of legacy
        Windows 3.x and DOS applications, and to be fair to a
        great extent they succeeded, but at what cost?</p>
        <p>Windows 95 still runs on DOS, it&#146;s
        DOS 7.0, but it&#146;s still DOS with many of its legacy
        faults that the virus writers can use to their benefit
        and to your detriment.</p>
        </td>
    </tr>
    <tr>
        <td><b></b><p><b>Effects on Anti-Virus software?<br>
        </b></p>
        <div align="center"><center><table border="1" cellspacing="0" width="568">
            <tr>
                <td valign=top width="23%" >
                <td valign=top width="25%" >
                <td valign=top width="27%" >
                <td valign=top width="26%" >
            </tr>
            <tr>
                <td valign=top width="23%">
                <td valign=top width="25%">
                <td valign=top width="27%">
                <td valign=top width="26%">Ghost positive when trying
                to remove MBR infector!</p>
                </td>
            </tr>
            <tr>
                <td valign=top width="23%">
                <td valign=top width="25%">
                <td valign=top width="27%">
                <td valign=top width="26%">The Magic Bullet natively supports
                Fat32.</td>
            </tr>
            <tr>
                <td valign=top width="23%">
                <td valign=top width="25%">
                <td valign=top width="27%">
                <td valign=top width="26%">Error reading DBR message on
                infected FAT32 DBR.</td>
            </tr>
            <tr>
                <td valign=top width="23%">
                <td valign=top width="25%">
                <td valign=top width="27%">
                <td valign=top width="26%">Access denied when accessing
                infected FAT32 DBR or MBR.</td>
            </tr>
            <tr>
                <td valign=top width="23%">
                <td valign=top width="25%">
                <td valign=top width="27%">
                <td valign=top width="26%">
                Abort, Retry, Fail.<br>
                Only continues and remove DBR infector if FAIL
                selected.<p>Ghost
                positive when trying to remove MBR infector!
                FAT32 Support.</p>
                </td>
            </tr>
            <tr>
                <td valign=top width="23%">
                <td valign=top width="25%">
                <td valign=top width="27%">
                <td valign=top width="26%">
            </tr>
            <tr>
                <td valign=top width="23%">
                <td valign=top width="25%">
                <td valign=top width="27%">
                <td valign=top width="26%">Bad Logical Sector C:|0 message when
                trying to remove DBR infector.<p>Detected MBR infector but
                would not disinfect.</p>
                </td>
            </tr>
            <tr>
                <td valign=top width="23%">
                <td valign=top width="25%">
                <td valign=top width="27%">
                <td valign=top width="26%">Native FAT32 Support. No problems
                encountered.</td>
            </tr>
        </table>
        </center></div></td>
    </tr>
    <tr>
        <td><b></b><p><b>Effects of Boot Sector [DBR]
        viruses?</b></p>
        <p><b><i>Putting the Boot in</i></b></p>
        <p>Boot sector [DBR] viruses infect the
        computer when an infected floppy diskette is attempted to
        be booted from (<i>assuming that the CMOS boot sequence
        is the standard A: then C:. If it&#146;s set to C: then
        A: then standard DBR (and MBR) viruses (excluding
        droppers) don&#146;t stand a chance</i><sup><i>[Overton]</i></sup>).
        The virus in the infected diskette boot sector will try
        to go resident and infect the DBR of the hard disk. If
        successful, and the virus can operate correctly on the
        host operating system then the virus will try to infect
        any diskette that is not write protected accessed in the
        floppy drives of the system.</p>
        </td>
    </tr>
    <tr>
        <td><b><i></i></b><p><b><i>FAT16 DBR Viruses vs. FAT32</i></b></p>
        <p>It is not surprising that this group of
        viruses has the most profound impact on FAT32 partitions,
        as the Dos Boot Record has been radically changed.The
        boot record on FAT32 drives is greater than 1 sector. In
        addition, there is a sector in the reserved area on FAT32
        drives that contains values for the count of free
        clusters and the cluster number of the most recently
        allocated cluster</i>
        <p>To date (July 97) no FAT32 specific DBR
        infectors exist. This is not to say that they won&#146;t
        be created, as virus writers seem to fight to be the
        first to infect new operating systems or to use new
        techniques. I predict that we will see a FAT32 specific
        or FAT16/FAT32 DBR infector before the end of this year,
        if not sooner. It is only a matter of time after that
        happens before the first multi-partile virus that can
        infect the FAT32 DBR will be released.</p>
        </td>
    </tr>
    <tr>
        <td><b><i></i></b><p><b><i>Infected DBR or MBR? Confused? You
        Will Be!</i></b></p>
        <p>When Windows 95 is infected by a DBR or
        MBR infector, and is first booted, in most cases the
        following dialogue box is displayed.</p><br>
        <em><strong>Fig 1</strong></em></p>
        <p align="left">Bear in mind that this is
        only displayed the <i>first</i> time after the original
        infection. This dialogue box is a step in the right
        direction for Microsoft, as it actually mentions the word
        &#145;<i>Virus</i>&#146;. This may encourage an infected
        user to actually use some anti-virus software to check
        their system for viruses, or maybe not.</p>
        <p>The confusing part of this story is
        that if the DBR is infected this message is also
        displayed. I would have expected Microsoft to know the
        difference between a DBR and an MBR, obviously this is
        not the case!</p>
        <p>Many users would simply ignore this
        message and carry on regardless.</p>
        <p>If you select the Yes button on this
        dialogue box you will see the following detailed dialogue
        box.</p>
	<br>
        <em><strong>Fig 2</strong></em></p>
        <p>As you can clearly see this informs you
        that your system is using the MS-DOS compatibility mode
        for both the File System and Virtual Memory.</p>
        <p>It also offers the following
        information, which the user should be more than a little
        curious to read, especially as it states:</p>
        <p align="center"><b>&#145;</b><b><i>Compatibility
        mode paging reduces overall system performance&#146;</i></b></p>
        <p align="center"><b>and</b></p>
        <p align="center"><b>&#145;</b><b><i>Master
        Boot Record modified --SEE IMPORTANT DETAILS.</i></b><b>&#146;</b></p>
        <p align="left">On most systems that are
        properly configured and not infected by one of the many
        MBR or DBR viruses, the following dialogue box would be
        shown instead.</p>
	<br>
        <em><strong>Fig 3</strong></em></p>
        <p>This dialogue box clearly shows that
        32-bit access to Virtual Memory and the File System is
        being used.</p>
        <p>It has been said many times that
        Microsoft looks toward functionality first, security has
        always been the poor relation and it seems that it is
        almost an after thought, some of you may feel that I am
        understating this point.</p>
        <p>Microsoft has been of recently talking
        to many of the anti-virus industries largest players to
        form a working party on Macro virus issues with Microsoft
        products. I look forward to the outcome from this
        undertaking. Unfortunately (for the end user) I predict
        any expectations will fall short, and the anti-virus
        industry will be required to charge to the rescue again
        to thwart the virus foe.</p>
        </td>
    </tr>
    <tr>
        <td><b></b><p><b>Myth #2?</b></p>
        <p><i>DBR viruses cannot be removed from
        FAT32 partitions by non-FAT32 compatible anti-virus
        software.</i></p>
        <p>Currently there are no FAT32 specific
        viruses, not to say that they will not be created in the
        future. Non-FAT32 compatible scanners appear to be unable
        to successfully remove the current FAT16 DBR viruses.</p>
        <p>My findings with the DBR infectors and
        scanners tested for this paper appear to validate this
        supposed myth!. Disconcertingly, my results with genuine
        infections appear to be the completely opposite to some
        postings by notable researchers on the Alt.Comp.Virus
        newsgroup. </p>
        <p><i>Is the </i><i><u>truth</u></i><i>
        out there?</i></p>
        </td>
    </tr>
    <tr>
        <td><b><i></i></b><p><b><i>Test Results</i></b></p>
        <p>Swiss-Boot.A resisted all attempts to
        remove it by anti-virus software. It had to be manually
        removed using <i>SYS C:</i> after booting from a clean
        boot disk and locking the C: drive with the <i>LOCK C:</i>
        command.</p>
        <p>FORM.A was also resistant to removal,
        only being successfully removed using Dr. Solomon&#146;s
        Magic bullet, McAfee 3.0.3 and Vet 9.44, which are all
        FAT32 aware.</p>
        <p>Although some researchers insist that
        DBR infectors can be removed from FAT32 drives by FAT16
        compatible scanners, my tests seem to indicate the
        opposite. This obviously needs more investigation.<br>
        </p>
        <div align="center"><center><table border="1" cellspacing="1" width="567">
            <tr>
                <td valign=top width="22%" >
                <td valign=top width="12%" ><p align="center">Infected
                OK?</b></p>
                </td>
                <td valign=top width="13%" ><p align="center">Detected
                by &#146;95?</b></p>
                </td>
                <td valign=top width="13%" ><p align="center">Clean
                Boot?</b></p>
                </td>
                <td valign=top width="13%" ><p align="center">
                </td>
                <td valign=top width="27%" ><p align="center">
                </td>
            </tr>
            <tr>
                <td valign=top width="22%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Only removed by Dr. Solomon&#146;s
                Magic Bullet, which is FAT32 compatible.<p>Still infected other
                floppies.</p>
                </td>
            </tr>
            <tr>
                <td valign=top width="22%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                <p align="center">Invalid
                Media</p>
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Only removed by Dr. Solomon&#146;s
                Magic Bullet, which is FAT32 compatible.<p>Still infected other
                floppies.</p>
                </td>
            </tr>
            <tr>
                <td valign=top width="22%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">While initializing VBACKUP
                could not load VFD.VXD</p>
                <p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Any attempt to SYS or remove this
                virus after a clean boot resulted in a message
                indicating that the drive was locked.<p>Clean booting and using the
                LOCK C: command and then running SYS C: cleared
                the virus correctly.</p>
                <p>Dr. Solomon&#146;s
                Magic Bullet, reported that the drive was write
                protected.</p>
                </td>
            </tr>
        </table>
        </center></div></td>
    </tr>
    <tr>
        <td><b></b><p><b>Effects of Partition Sector
        [MBR] viruses?</b></p>
        <p><b>Myth #3</b></p>
        <p><i>MBR viruses cannot be removed from
        FAT32 partitions by non-FAT32 compatible anti-virus
        software.</i></p>
        <p>This, you might think after <i>Myth#2</i>,
        and you&#146;d be excused for thinking this, would be
        correct. Luckily for most MBR infectors this is not the
        case. In testing all the MBR viruses were successfully
        removed, without incident. Why is this the case, when DBR
        viruses refused to give up without a struggle?</p>
        <p>The simple answer is that the MBR under
        FAT32 is practically the same as under DOS 6.0.
        Therefore, currently non-FAT32 compatible scanners can (<i>in
        almost all cases</i>) safely remove MBR viruses from
        FAT32 drives.</p>
        <p><b><i>Test Results</i></b></p>
        <p>This was an interesting group of
        viruses, especially as all of them were unable to infect
        floppy disks from within the Windows 95 GUI or DOS boxes
        run within it. (W<i>hile I was completing this paper, a
        new MBR infector was reported that could infect from
        within the Windows 95 GUI, the virus is known as Dodgy or
        Ravage</i><sup><i>[Dr. Sol]</i></sup>). The greatest
        surprise was how badly some of the MBR viruses fared when
        trying to infect in &#145;<i>MS-DOS Compatibility Mode</i>&#146;
        and/or the &#145;<i>Command Prompt Only</i>&#146; boot
        option mode.</p>
        <p><b>STOP PRESS</b>: <i>Dodgy</i> has
        been tested and the results added to the table below.
        This MBR infector can infect floppy disks in all the test
        modes. It does this by deleting the <i>HSFLOP.PDR</i>
        file from the <i>WINDOWS\SYSTEM\IOSUBSYS</i> directory.
        This simply removes the 32-bit floppy driver support, so
        that next time Windows &#145;95 starts, the floppy drive
        is accessed using standard<i> DOS BIOS</i> routines
        instead. This type of attack is not new; the <i>Hare</i>
        family of viruses used this method too. Although in the
        tests carried out for this paper all <i>Hare</i> samples
        tested failed to go resident and infect the MBR or any
        files.</p>
        <p>One thing to bear in mind, just because
        an MBR infector can&#146;t spread does not mean it is not
        a threat. Take <i>Kampana</i> as an example, even though
        it failed to replicate in testing, confirmed by at least
        one third party<sup>[Emm]</sup> , it&#146;s payload will
        almost certainly still trigger (<i>after 400 reboots, it
        overwrites the hard disk with garbage, then displays its
        message</i>). Others that refused to spread include<i>:
        AntiCMOS.A, Jumper.A, Stoned.Standard.A and V-Sign.A.</i></p>
        <p>Some of the test group offered &#145;<i>General
        Failure Reading Drive A:</i>&#146; messages, these were: <i>Michelangelo,
        ExeBug.C and Stoned.16</i>.</p>
        <p><i>Quox</i> refused to allow Windows 95
        to boot, and would only infect floppy disks entered
        during the &#145;<i>Diskette Read Failure</i>&#146;
        message, which could not be bypassed.</p>
        <p>Those that performed best, infecting on
        both 3 &amp; 4, were: <i>AntiEXE.A, Leandro,
        ParityBoot.B, Ripper, Sampo, Stoned.Azuza,
        Stoned.Angelina, W-Boot.A and Welcomb</i>.</p>
        <p>There were a number of MBR infectors
        that would only infect under condition 4, these include: <i>Monkey.B,
        NYB, and Stealth_Boot.C.</i></p>
        <p>All of those that successfully infected
        the MBR and went resident, apart from <i>Jumper.A</i>
        caused Windows 95 to report that the MBR had been changed
        (<i>Fig 1</i>), which dropped Windows 95 file and memory
        system mode from 32-bit (<i>Fig 3</i>) into MS-DOS
        Compatibility mode (<i>Fig 2</i>). Interestingly, even
        though the hard drive is in MS-DOS mode, the floppy
        driver is still running in 32 Bit mode<sup>[CN]</sup> <i>(that
        is why the floppy disks are not infected within the GUI
        by the viruses tested even though they infected the hard
        drives MBR and are resident</i>).</p>
        <p>Why did all of the viruses that
        infected the MBR and went resident except <i>Jumper.A</i>
        have Windows 95 detect the change? The answer isn&#146;t
        all that mystical, simply all other tested MBR infectors
        hook Int 13h and Windows 95 actually monitors the Int 13h
        vector code for modifications (<i>not the actual MBR or
        DBR</i>) as this will affect its ability to drive the
        hardware directly. Not surprisingly most MBR infectors
        will do just that. <i>Jumper.A</i> on the other hand
        hooks not Int 13h but Int 21h instead, this means that
        Windows 95 can&#146;t see the change and therefore the
        warning messages are not shown.</p>
        <p><i>Filler.A</i> ,<i>Chinese-Fish</i>
        and both <i>Hare</i> samples refused to even go resident,
        let alone infect the test systems MBR.</p>
        <p>On a clean boot all was fine except as
        expected for <i>Monkey.B</i> (<i>as it encrypts the MBR</i>),
        and <i>ExeBug.C</i> (<i>Invalid drive specification when
        accessing drive C:</i>). Even given these errors, the viruses were still
        correctly and easily removed, even with non-FAT32
        specific scanners.</p>
        <p>A number of the test set hung after
        infecting the hard drive, instead of giving the more
        usual &#145;<i>Invalid system disk Replace the disk, and
        press any key</i>&#146; or &#145;<i>Non-system disk or
        disk error Replace and strike any key when ready</i>&#146;messages.
        This simply needed the system to be rebooted for Windows
        95 to load as normal, except for the warning messages (<i>Fig1
        and Fig3</i>). The viruse exhibiting this phenomenen
        were: <i>AntiCMOS.A, Leandro, Parity_Boot.B and Stoned.16</i>.</p>
        <p>The really interesting results are when
        these test results are compared to tests conducted by <i>Ian
        Whalley</i><sup><i>[Whalley]</i></sup><i>. </i>All the
        MBR and DBR viruses he tested replicated under FAT16
        [4.00.950]. The viruses he tested were: <i>AntiCMOS,
        AntiEXE, Monkey.B, Form, Jumper.B, NYB, ParityBoot.B,
        Quandry, Sampo, Stoned.Angelina and V-Sign</i>.</p>
        <p>Yet in another test conducted <sup>[VB2]</sup>,
        <i>Jumper</i> failed to infect other floppies as found in
        the tests carried out for this paper. On the other hand <i>Kampana</i>
        and <i>V-Sign</i> apparently did replicate in the same
        test conducted by Virus Bulletin, but failed to when
        tested for this paper!</p>
        <p>But if we look closer these tests<sup>[VB2]</sup>
        were done on a pre-release version of Windows 95
        [4.00.347] and this may go some way to explain the
        anomolies found in this and other tests by Ian Whalley
        [4.00.950]<sup>[Whalley]</sup> and David Emm [4.00.950]<sup>[Emm]</sup>
        when compared with later versions of Windows 95 tested
        for this paper [4.00.1111].</p>
        <p>As you can see the results are somewhat
        different. Are the different results due to FAT32 and or
        other changes in OSR 2.x, or something else? I feel that
        more testing is required to get the diffinitive answer,
        and unfortunately this is beyond the scope of this paper.<br>
        </p>
        <div align="center"><center><table border="1" cellspacing="1" width="567">
            <tr>
                <td valign=top width="22%" >
                <td valign=top width="13%" ><p align="center">Infected
                OK?</b></p>
                </td>
                <td valign=top width="12%" ><p align="center">Detected
                by &#146;95?</b></p>
                </td>
                <td valign=top width="13%" ><p align="center">Clean
                Boot?</b></p>
                </td>
                <td valign=top width="13%" ><p align="center">
                </td>
                <td valign=top width="27%" ><p align="center">
                </td>
            </tr>
            <tr>
                <td valign=top width="22%">
                <td valign=top width="13%"><p align="center">
                <p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Won&#146;t infect another floppy at
                all</td>
            </tr>
            <tr>
                <td valign=top width="22%">
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">
            </tr>
            <tr>
                <td valign=top width="22%">
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="12%">&nbsp;</td>
                <td valign=top width="13%">&nbsp;</td>
                <td valign=top width="13%">&nbsp;</td>
                <td valign=top width="27%">
            </tr>
            <tr>
                <td valign=top width="22%">
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">1 &amp; 2 Only on next restart,
                deletes HSFLOP.PDR, 3 &amp; 4 straight after
                infection.</td>
            </tr>
            <tr>
                <td valign=top width="22%">
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                <p align="center">Invalid
                drive specification when accessing drive C:</p>
                </td>
                <td valign=top width="13%">&nbsp;</td>
                <td valign=top width="27%">Infects on 3 only, General
                failure reading drive A on 4</p>
                </td>
            </tr>
            <tr>
                <td valign=top width="22%">
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="12%">&nbsp;</td>
                <td valign=top width="13%">&nbsp;</td>
                <td valign=top width="13%">&nbsp;</td>
                <td valign=top width="27%">Won&#146;t infect MBR or go
                resident.</td>
            </tr>
            <tr>
                <td valign=top width="22%">
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="12%">&nbsp;</td>
                <td valign=top width="13%">&nbsp;</td>
                <td valign=top width="13%">&nbsp;</td>
                <td valign=top width="27%">Won&#146;t infect MBR or go
                resident.</td>
            </tr>
            <tr>
                <td valign=top width="22%">
                <td valign=top width="13%"><p align="center">
                <p align="center">
                </td>
                <td valign=top width="12%">&nbsp;</td>
                <td valign=top width="13%">&nbsp;</td>
                <td valign=top width="13%">&nbsp;</td>
                <td valign=top width="27%">Won&#146;t infect MBR or go
                resident.</td>
            </tr>
            <tr>
                <td valign=top width="22%">
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Won&#146;t infect another floppy at
                all</td>
            </tr>
            <tr>
                <td valign=top width="22%">
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Won&#146;t infect another floppy at
                all</td>
            </tr>
            <tr>
                <td valign=top width="22%">
                <td valign=top width="13%"><p align="center">
                <p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">
            </tr>
            <tr>
                <td valign=top width="22%">
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">General failure reading drive A on 3
                &amp; 4, but floppy still infected.</td>
            </tr>
            <tr>
                <td valign=top width="22%">
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                <p align="center">Invalid
                Media</p>
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">
            </tr>
            <tr>
                <td valign=top width="22%">
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">
            </tr>
            <tr>
                <td valign=top width="22%">
                <td valign=top width="13%"><p align="center">
                <p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">
            </tr>
            <tr>
                <td valign=top width="22%">
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="12%">&nbsp;</td>
                <td valign=top width="13%">&nbsp;</td>
                <td valign=top width="13%">&nbsp;</td>
                <td valign=top width="27%">On boot infects other
                diskettes.</p>
                </td>
            </tr>
            <tr>
                <td valign=top width="22%">
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">
            </tr>
            <tr>
                <td valign=top width="22%">
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                <p align="center">Hang
                &amp; Reboot</p>
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Hang &amp; Reboot cycles
                until Safe Mode chosen, then when restarted in
                normal mode Exception OE Occurs</p>
                </td>
            </tr>
            <tr>
                <td valign=top width="22%">
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">
            </tr>
            <tr>
                <td valign=top width="22%">
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Appears to disinfect itself
                on 4, virus no longer found after that.</p>
                </td>
            </tr>
            <tr>
                <td valign=top width="22%">
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">
            </tr>
            <tr>
                <td valign=top width="22%">
                <td valign=top width="13%"><p align="center">
                <p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">General failure reading drive A on 3
                &amp; 4, but floppy still infected</td>
            </tr>
            <tr>
                <td valign=top width="22%">
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">
            </tr>
            <tr>
                <td valign=top width="22%">
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">
            </tr>
            <tr>
                <td valign=top width="22%">
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">General failure reading drive A on 3
                &amp; 4, but floppy still infected</td>
            </tr>
            <tr>
                <td valign=top width="22%">
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infects on 3 &amp; 4 only, some
                directory entries corrupted.</td>
            </tr>
            <tr>
                <td valign=top width="22%">
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Won&#146;t infect another floppy at
                all</td>
            </tr>
            <tr>
                <td valign=top width="22%">
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Won&#146;t infect another floppy at
                all</td>
            </tr>
            <tr>
                <td valign=top width="22%" height="13">
                <td valign=top width="13%" height="13"><p align="center">
                </td>
                <td valign=top width="12%" height="13"><p align="center">
                </td>
                <td valign=top width="13%" height="13"><p align="center">
                </td>
                <td valign=top width="13%" height="13"><p align="center">
                </td>
                <td valign=top width="27%" height="13">Won&#146;t infect another
                floppy at all</td>
            </tr>
            <tr>
                <td valign=top width="22%">
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">
            </tr>
            <tr>
                <td valign=top width="22%">
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">
            </tr>
        </table>
        </center></div></td>
    </tr>
    <tr>
        <td><p align="center">1 = <i>From Explorer
        (My Computer A:) </i><br>
        2 = <i>DOS BOX Within 95 <br>
        </i>3 = <i>Restart in MS-DOS Compatibility Mode<br>
        </i>4 = <i>Restart, F8 and Command Prompt Only</i></p>
        </td>
    </tr>
    <tr>
        <td><b></b><p><b>Effects of File Infecting
        viruses?</b></p>
        <p><b><i>Myth #4</i></b></p>
        <p><i>You can&#146;t boot clean from an
        OSR2 boot disk, the virus is still found in memory.</i></p>
        <p>This rumour has been impossible to
        verify first hand. I contacted Virus Bulletin and spoke
        to Nick Fitzgerald (<i>the editor</i>) and he confirmed
        that this rumour was passed to him via trusted third
        parties.</p>
        <p>The situation, in which this problem
        appears to occur, is where small drives or small
        partitions are used. It is possible that after booting
        from the Windows 95 rescue disk and running your
        anti-virus software that it may report that the virus is
        still in memory (<i>even though it really isn&#146;t
        (this is known as a false positive or ghost positive</i>)).
        To resolve this issue simply add a 
        file with the following entry: 
        <p>It is further suggested to address this
        problem that you use a DOS 6.x boot disk to clean boot
        from before trying to remove an MBR infector.</p>
        <p><b>STOP PRESS: </b>After further
        research I managed to confirm this myth when either <i>McAfee</i>
        or <i>Norton</i> <i>Anti-Virus</i> was used after a clean
        boot. The tips suggested were tried and appeared not to
        alleviate the false alarm problem with these products.
        All the other scanners tested did not suffer from this
        false alarm problem.</p>
        <p><b><i>Test Results</i></b></p>
        <p>This set of viruses gave the widest
        range of results, not surprising really when you consider
        the number of different types of file infecting viruses
        there are.</p>
        <p>A number of viruses that went resident
        completely refused to infect any files whatsoever. These
        include old and new viruses, such as<i>: Tequila, Cawber,
        Die_Hard, both Hare samples and Ginger.</i></p>
        <p>Others just produced the &#145;<i>illegal
        operation</i>&#146; dialogue box (<i>Fig 4</i>), and
        refused to do anything more. These included: <i>Goldbug,
        DarkAvenger.1800 and 2100, Neuroquilla and MacGyver.</i></p>
	<br>
        <em><strong>Fig 4</strong></em></p>
        <p>A further subset produced the more
        drastic &#145;<i>Fatal Exception xx</i>&#146; message
        that invariably ended up with the system either becoming
        extremely unstable or having to be restarted. These
        included: <i>ByWay, Green Caterpillar, Tremor and Frodo.</i></p>
        <p>There were a reasonable number of
        viruses that could survive and replicate successfully
        within a single DOS box. These included: <i>Anticad.4096.Mozart,
        Avispa and even old favourites such as Cascade and all of
        the tested Jerusalem variants</i>.</p>
        <p>A few viruses could survive and
        replicate in all DOS boxes, these were: <i>Barrotes.1303
        and Three_Tunes.1784. </i>Both these viruses infected<i>
        COMMAND.COM, </i>so this may explain why this was
        possible, although other viruses infected <i>COMMAND.COM</i>
        but were not viable outside the single DOS box they went
        resident in, these were: <i>Barrotes.1310.A, CPW.1527,
        Fairz, Kaos4 and Npox.963.A</i>.</p>
        <p>Only one that could infect not only all
        target files, in all DOS boxes but also could infect DOS
        files executed from Explorer! This was: <i>No_Frills.Dudley</i>.</p>
        <p>Comparing these results with other
        papers that have tested earlier versions of Windows 95
        shows similar results. David Emm&#146;s paper <sup>[Emm]</sup>
        confirms the findings here with regard to <i>Cascade</i>
        and <i>Yankee.Doodle</i> and <i>Frodo</i>, but not <i>Tequila</i>.
        The difference with <i>Tequila</i> may be explained by
        the use of FAT32 partitions in this paper compared to
        FAT16 in his tests. The test carried out by Ian Whalley <sup>[Whalley]</sup>,
        confirms the behaviour observed with <i>ByWay</i>, <i>Jerusalem,
        Kaos4 and Taipan.438</i>.</p>
        <p>It appears that the tests carried out
        for this paper use the largest set of viruses of the
        known papers written to date. In many ways I can
        understand why as this level of testing is rather time
        consuming.<br>
        </p>
        <div align="center"><center><table border="1" cellspacing="1" width="567">
            <tr>
                <td valign=top width="27%" >
                <td valign=top width="12%" ><p align="center">Infected
                OK?</b></p>
                </td>
                <td valign=top width="12%" ><p align="center">Detected
                by &#146;95?</b></p>
                </td>
                <td valign=top width="10%" ><p align="center">Clean
                Boot?</b></p>
                </td>
                <td valign=top width="13%" ><p align="center">
                </td>
                <td valign=top width="27%" ><p align="center">
                </td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM files in same DOS
                box.</td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.EXE files in same DOS
                box.</td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                <p align="center">
                </td>
                <td valign=top width="12%">&nbsp;</td>
                <td valign=top width="10%">&nbsp;</td>
                <td valign=top width="13%">&nbsp;</td>
                <td valign=top width="27%">
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM &amp; *.EXE files in
                ALL DOS boxes.<p>
                <p>Won&#146;t infect
                files from Explorer.</p>
                </td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM files in same DOS
                box.<p>Infected
                COMMAND.COM</p>
                </td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                <p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Invalid Media Type reading type C:
                Missing COMMAND.COM<p>
                </td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">
                </td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM files in same DOS
                box.</td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM files in same DOS
                box.</td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                <p align="center">Went
                Resident</p>
                </td>
                <td valign=top width="12%">&nbsp;</td>
                <td valign=top width="10%">&nbsp;</td>
                <td valign=top width="13%">&nbsp;</td>
                <td valign=top width="27%">
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM &amp; *.EXE files in
                same DOS box.</td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM &amp; *.EXE files in
                same DOS box.<p>Message: &quot;Cannot Execute
                &lt;filename&gt;&quot; when resident.</p>
                </td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%">&nbsp;</td>
                <td valign=top width="10%">&nbsp;</td>
                <td valign=top width="13%">&nbsp;</td>
                <td valign=top width="27%">
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM &amp; *.EXE files in
                same DOS box.<p>
                </td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%">&nbsp;</td>
                <td valign=top width="10%">&nbsp;</td>
                <td valign=top width="13%">&nbsp;</td>
                <td valign=top width="27%">
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%">&nbsp;</td>
                <td valign=top width="10%">&nbsp;</td>
                <td valign=top width="13%">&nbsp;</td>
                <td valign=top width="27%">
                </td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%">&nbsp;</td>
                <td valign=top width="10%">&nbsp;</td>
                <td valign=top width="13%">&nbsp;</td>
                <td valign=top width="27%">
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                <p align="center">
                </td>
                <td valign=top width="12%">&nbsp;</td>
                <td valign=top width="10%">&nbsp;</td>
                <td valign=top width="13%">&nbsp;</td>
                <td valign=top width="27%">
                </td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%">&nbsp;</td>
                <td valign=top width="10%">&nbsp;</td>
                <td valign=top width="13%">&nbsp;</td>
                <td valign=top width="27%">
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%">&nbsp;</td>
                <td valign=top width="10%">&nbsp;</td>
                <td valign=top width="13%">&nbsp;</td>
                <td valign=top width="27%">Illegal Instruction, Program
                Terminated.<p>Nothing
                infected.</p>
                </td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM *.EXE in same DOS
                box.<p>Infected
                COMMAND.COM</p>
                </td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM files in same DOS
                box.</td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM *.EXE in same DOS
                box.</td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM *.EXE in same DOS
                box.</td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM *.EXE in same DOS
                box.</td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%">&nbsp;</td>
                <td valign=top width="10%">&nbsp;</td>
                <td valign=top width="13%">&nbsp;</td>
                <td valign=top width="27%">
                </td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                <p align="center">
                </td>
                <td valign=top width="12%">&nbsp;</td>
                <td valign=top width="10%">&nbsp;</td>
                <td valign=top width="13%">&nbsp;</td>
                <td valign=top width="27%">
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">
                </td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%">&nbsp;</td>
                <td valign=top width="10%">&nbsp;</td>
                <td valign=top width="13%">&nbsp;</td>
                <td valign=top width="27%">
                <p>On reboot
                COMMAND.COM found to be infected.</p>
                </td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%">&nbsp;</td>
                <td valign=top width="10%">&nbsp;</td>
                <td valign=top width="13%">&nbsp;</td>
                <td valign=top width="27%">
                </td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%">&nbsp;</td>
                <td valign=top width="10%">&nbsp;</td>
                <td valign=top width="13%">&nbsp;</td>
                <td valign=top width="27%">
                </td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM *.EXE in same DOS
                box.</td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%">&nbsp;</td>
                <td valign=top width="10%">&nbsp;</td>
                <td valign=top width="13%">&nbsp;</td>
                <td valign=top width="27%">
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM *.EXE in same DOS
                box.</td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM files in same DOS
                box.</td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM *.EXE in same DOS
                box.</td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM *.EXE in same DOS
                box.</td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">No files infected in DOS
                Box.</p>
                </td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM *.EXE in same DOS
                box.<p>Infected
                COMMAND.COM &amp; WIN.COM</p>
                </td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM *.EXE in same DOS
                box.</td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM &amp; *.EXE in same
                DOS box.</td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM *.EXE in same DOS
                box.</td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM *.EXE in same DOS
                box.</td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">
                </td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM *.EXE in same DOS
                box.</td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%">&nbsp;</td>
                <td valign=top width="10%">&nbsp;</td>
                <td valign=top width="13%">&nbsp;</td>
                <td valign=top width="27%">
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%">&nbsp;</td>
                <td valign=top width="10%">&nbsp;</td>
                <td valign=top width="13%">&nbsp;</td>
                <td valign=top width="27%">
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM *.EXE in same DOS
                box.</td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                <p align="center">From
                DOS Box</p>
                <p align="center">
                <p align="center">In
                DOS Mode</p>
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected MBR, MEM.EXE, WIN.COM,
                DBLBUFF.SYS, COMMAND.COM and SETVER.EXE</p>
                </td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">
                </td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM *.EXE in same DOS
                box.<p>Fatal
                Exception 06 at 9EDD:00000560 when exiting DOS
                box.</p>
                <p>
                </td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM *.EXE in same ALL DOS
                boxes, and files executed from Explorer.<p>
                </td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM *.EXE in same DOS
                box.</td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM *.EXE in same DOS
                box.<p>Infected
                COMMAND.COM</p>
                </td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">
                </td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM *.EXE in same DOS
                box.</td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM &amp; *.EXE in same
                DOS box.</td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM *.EXE in same DOS
                box.</td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%">&nbsp;</td>
                <td valign=top width="10%">&nbsp;</td>
                <td valign=top width="13%">&nbsp;</td>
                <td valign=top width="27%">
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM &amp; *.EXE in same
                DOS box.</td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%">&nbsp;</td>
                <td valign=top width="10%">&nbsp;</td>
                <td valign=top width="13%">&nbsp;</td>
                <td valign=top width="27%">
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM &amp; *.EXE in same
                DOS box.</td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM &amp; *.EXE in same
                DOS box.</td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM &amp; *.EXE in same
                DOS box.</td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.EXE files in same DOS
                box.</td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected DEFRAG.EXE, TWUNK_16.EXE,
                SCANDSKW.EXE</td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM files in same DOS
                box.</td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%">&nbsp;</td>
                <td valign=top width="10%">&nbsp;</td>
                <td valign=top width="13%">&nbsp;</td>
                <td valign=top width="27%">
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.EXE files in ALL DOS
                boxes, but not from Explorer.<p>
                </td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%">&nbsp;</td>
                <td valign=top width="10%">&nbsp;</td>
                <td valign=top width="13%">&nbsp;</td>
                <td valign=top width="27%">
                </td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">
                </td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">
                </td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">
                </td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM &amp; *.EXE in same
                DOS box.</td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM &amp; *.EXE files in
                same DOS box.</td>
            </tr>
            <tr>
                <td valign=top width="27%">
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="12%"><p align="center">
                </td>
                <td valign=top width="10%"><p align="center">
                </td>
                <td valign=top width="13%"><p align="center">
                </td>
                <td valign=top width="27%">Infected *.COM &amp; *.EXE files in
                same DOS box.</td>
            </tr>
        </table>
        </center></div></td>
    </tr>
    <tr>
        <td><b><i></i></b><p><b><i>Shall I Compare Thee &#133;. to NT?</i></b></p>
        <p>As an interesting aside, it seemed
        useful to compare the results above with those reported
        by David Aubrey-Jones in his paper on NT<sup>[Jones]</sup>.</p>
        <p>Why, you may ask?</p>
        <p>Well the test set of viruses used here
        is a superset of those used for that paper. Therefore it
        seems useful to do some form of comparison of how viruses
        behave under GUI operating systems, well some of you may
        think so at least, so lets begin&#133;.</p>
        <p><b>DBR infectors:</b></p>
        <p>It is interesting that like FAT32, NT
        does like seem to like DBR infectors. Both <i>Form.A</i>
        and <i>Boot-437</i> stopped NT dead in its tracks.</p>
        <p><b>MBR Infectors:</b></p>
        <p>This set of viruses&#146; results under
        NT when compared to those reported in this paper is a
        little more varied. Of those that were unable to infect
        NTFS, only <i>Chinese Fish</i> also balked at FAT32
        infection. The others that refused on NTFS, but did not
        object to FAT32 were: <i>ExeBug.C, ParityBoot.B and
        V-Sign</i>.</p>
        <p>Those that infected NTFS fine without
        causing a hang were: <i>AntiCMOS.A, NYB, Ripper, NYB and
        Stoned.Standard.A. </i>All of these were perfectly able
        to infect and either refused to infect another host, or
        spread only under limited circumstances on FAT32.</p>
        <p>Those that caused NT to fail to boot
        were: <i>Kampana.A, StealthBoot.C and Monkey.B</i>. The
        results on FAT32 were not as drastic as on NFTS, all
        infected the MBR without incident and went resident.
        Kampana.A refused to infect any other host, both Monkey.B
        and StealthBoot.C would only infect under condition 4.</p>
        <p><b>File Infectors:</b></p>
        <p>This set of viruses most closely
        matched the results of the NT tests on NTFS. Of the 44
        successful file infecting viruses used in the NTFS test
        and in this paper, only 6 refused to infect and spread
        under FAT32. These were: <i>Die-Hard, HLLC.Even_Beeper.B,
        Markt.1533, Predator.2448, Sayha and Tremor</i>.</p>
        <p>Of the 19 file infecting viruses that
        refused to operate on NT on NTFS, that were also used in
        the tests for this paper, 10 refused to work at all or
        produced error messages. The remaining 9 that failed
        under NTFS worked at least partially under FAT32. These
        were: <i>BootExe.451, GreenCaterpillar.1575, Junkie,
        Maltese Amoeba, Natas.4744, One-half.3544,
        Pathogen:Smeg.0_1, SVC.3103.A and Tentacle</i>.</p>
        <p>It appears that the greater part of the
        viruses tested under NTFS and FAT32 appear to work at
        least reasonably, though many shoot themselves in the
        foot by trying to be too clever.</p>
        <p>&nbsp;</p>
        </td>
    </tr>
    <tr>
        <td><b>Conclusions</b><p>As stated in the 1996 Virus Bulletin opening
        address by Steve White &quot;<i>Microsoft has done more
        to solve the virus problem than the anti-virus industry</i>&quot;,
        this I believe is still true today, although the
        anti-virus community have not been napping.</p>
        <p>FAT32 has brought a new level of
        problems for the virus writer to overcome. The simpler
        viruses appear to work best, those that are trying to be
        clever, use excessive stealth or undocumented or unusual
        features seem most likely to come unstuck.</p>
        <p>It is clear from other papers written
        on Windows 95 and viruses, when compared to the tests
        carried out for this paper, that FAT32 has caused more
        problems for certain classes of viruses. In some
        situations either causing the virus to be unable to go
        resident or the more annoying and potentially dangerous
        situation where the virus is resident, but cannot
        replicate although the trigger routine is still viable
        and potentially destructive.</p>
        <p>The main viruses that appear to be
        seriously inconvenienced are the DBR infectors. These in
        the tests conducted give themselves away very quickly and
        noticeably.</p>
        <p>Macro viruses appear to be the least
        affected by the appearance of FAT32, which is not
        surprising in that the operating system that macro
        viruses run within are currently Word, Excel and WordPro.
        A small number of these viruses may be caught out, but in
        the main this is likely to be the main threat to Windows
        95 users, at least until FAT32 compatible DBR infectors
        and more 32-bit Windows 95/NT viruses appear.</p>
        <p>Furthermore, it is clear that the
        anti-virus software tested for this paper, that non-FAT32
        compatible scanners cannot remove DBR viruses from an
        infected FAT32 partition. Of course before long all
        anti-virus software will have to be FAT32 compatible
        because it is certain that some miscreant will write a
        FAT32 DBR infector just to prove it can be done.</p>
        <p>The appearance of Dodgy is rather
        timely, although this is not a FAT32 specific virus it
        uses known anti-Windows &#146;95 32 driver attacks. Could
        this the forerunner to the first FAT32 compatible DBR
        virus?</p>
        <p>&nbsp;</p>
        </td>
    </tr>
    <tr>
        <td><b>Appendices</b><p><b><i>Technical Implementation</i></b></p>
        <p>The following information is supplied
        to show the changes that have taken place with the advent
        of FAT32. This not only covers the changes in the DBR but
        other interrupt routines for disk access and free space
        detection, amongst others. There is little discussion of
        the information raised here as I feel that this would be
        only useful to the virus authors, rather than the AV
        industry as they already have this information available
        to them and more besides.</p>
        <p>The following are all the valid
        partition types and their corresponding values for use in
        the <b>Part_FileSystem</b>&nbsp;member of the <b>s_partition
        (FAT32)</b> structure.<br>
        </p>
        <div align="center"><center><table border="1" cellspacing="1" width="585">
            <tr>
                <td width="29%">Partition
                Types</b> <b>Value </b></td>
                <td width="71%">Description
                </b></td>
            </tr>
            <tr>
                <td width="29%">
                <td width="71%">
            </tr>
            <tr>
                <td width="29%">
                <td width="71%">12-bit
                FAT</td>
            </tr>
            <tr>
                <td width="29%">
                <td width="71%">16-bit
                FAT. Partitions smaller than 32MB.</td>
            </tr>
            <tr>
                <td width="29%">
                <td width="71%">Extended
                MS-DOS Partition</td>
            </tr>
            <tr>
                <td width="29%">
                <td width="71%">16-bit
                FAT. Partitions larger than or equal to 32MB.</td>
            </tr>
            <tr>
                <td width="29%">
                <td width="71%">32-bit
                FAT. Partitions up to 2047GB.</td>
            </tr>
            <tr>
                <td width="29%">
                <td width="71%">Same
                as PART_DOS32(0Bh), but uses Logical Block
                Address Int 13h extensions.</td>
            </tr>
            <tr>
                <td width="29%">
                <td width="71%">Same
                as PART_DOS4_FAT(06h), but uses Logical Block
                Address Int 13h extensions.</td>
            </tr>
            <tr>
                <td width="29%">
                <td width="71%">Same
                as PART_EXTENDED(05h), but uses Logical Block
                Address Int 13h extensions.</td>
            </tr>
        </table>
        </center></div><p>Microsoft have added two
        new partition type markers to identify FAT32 partitions,
        these are 0Bh and 0Ch. Both these partition markers
        clearly identify the partition as FAT32.</p>
        <p><b><i>FAT32 File System Structures</i></b></p>
        <p>With the addition of the FAT32 file
        system, the BPB, DPB, and DEVICEPARAMS structures were
        updated to accommodate FAT32 information. Additionally,
        subordinate structures have been implemented to support
        the FAT32 file system main structures. These changes are
        effective for Windows OEM Service Release 2 and later.</p>
        <blockquote>
            <blockquote>
                <p>
                <b>BIGFATBOOTFSINFO</b>&nbsp;<b>(FAT32)</b><br>
                <b>DPB (FAT32)</b><br>
                <b>EA_DEVICEPARAMETERS</b>&nbsp;<b>(FAT32)</b><br>
                <b>ExtGetDskFreSpcStruc</b>&nbsp;<b>(FAT32)</b><br>
                <b><i>s</i></b><b>_partition</b>&nbsp;<b>(FAT32)</b><br>
                <b>SDPDFormatStruc (FAT32)</b></p>
            </blockquote>
        </blockquote>
        <p><b>Note:</b> Many data structures in
        this section are listed as <b>reserved</b>. This
        indicates that the user is not to assume or modify the
        values within these fields. They are used by the file
        system itself and are not available for any enhancements
        <p><b><i>Boot Sector and Bootstrap
        Modifications </i></b>
        <div align="center"><center><table border="1" cellspacing="1" width="576">
            <tr>
                <td width="25%">Reserved
                Sectors</b>&nbsp;</td>
                <td width="75%">FAT32
                drives contain more reserved sectors than FAT16
                or FAT12 drives. The number of reserved sectors
                is usually 32, but can vary.</td>
            </tr>
            <tr>
                <td width="25%">Boot
                Sector<br>
                Modifications</b>&nbsp;</td>
                <td width="75%">Because
                a FAT32 BIOS Parameter Block (BPB), represented
                by the <b>BPB (FAT32)</b> structure, is larger
                than a standard BPB, the boot record on FAT32
                drives is greater than 1 sector. In addition,
                there is a sector in the reserved area on FAT32
                drives that contains values for the count of free
                clusters and the cluster number of the most
                recently allocated cluster. These values are
                members of the <b>BIGFATBOOTFSINFO (FAT32)</b>&nbsp;structure
                which is contained within this sector. These
                additional fields allow the system to initialize
                the values without having to read the entire file
                allocation table.</td>
            </tr>
            <tr>
                <td width="25%">Root
                Directory</b>&nbsp;</td>
                <td width="75%">The
                root directory on a FAT32 drive is not stored in
                a fixed location as it is on FAT16 and FAT12
                drives. On FAT32 drives, the root directory is an
                ordinary cluster chain. The <b>A_BF_BPB_RootDirStrtClus</b>&nbsp;member
                in the <b>BPB (FAT32)</b>&nbsp;structure contains
                the number of the first cluster in the root
                directory. This allows the root directory to grow
                as needed. In addition, the <b>BPB_RootEntries</b>
                member of <b>BPB (FAT32)</b>&nbsp;is ignored on a
                FAT32 drive.</td>
            </tr>
            <tr>
                <td width="25%">Sectors
                Per FAT</b>&nbsp;</td>
                <td width="75%">&nbsp;member
                of <b>BPB (FAT32)</b>&nbsp;is <i>always</i> zero
                on a FAT32 drive. Additionally, the <b>A_BF_BPB_BigSectorsPerFat</b>&nbsp;and
                <b>A_BF_BPB_BigSectorsPerFatHi</b> members of the
                updated <b>BPB (FAT32)</b>&nbsp;provide
                equivalent information for FAT32 media.</td>
            </tr>
        </table>
        </center></div><p><b><i></i></b>&nbsp;</p>
        <p><b><i>Equipment Used</i></b></p>
        <blockquote>
            <p>Dell Optiplex GXi 500</p>
            <p>200Mhz MMX Processor</p>
            <p>32Mb Memory</p>
            <p>2GB SCSI Hard discSCSI (2GB Hard
            Disk on Adaptec Controller)</p>
            <ul>
                <li>Drive partitioned into 2 x1GB
                    partitions.</li>
                <li>Formatted to FAT32.</li>
            </ul>
        </blockquote>
        <blockquote>
            <p>Windows 95 OEM OSR 2.1</p>
            <p>116 viruses used in the tests were
            selected from the March 1997 edition of the
            &#145;Wild List&#146; published by Joe Wells. These
            were chosen as they are considered to be those most
            likely encountered by the user-community at large.</p>
        </blockquote>
        <p><b><i>Clean Boot Disk</i></b></p>
        <p>Created by running FORMAT.COM from the
        WINDOWS\SYSTEM directory with the /S switch and then
        copying SYS.COM and FDISK.EXE to it.</p>
        <p>&nbsp;</p>
        </td>
    </tr>
    <tr>
        <td><b><i>Alt.Comp.Virus Newsgroup
        Postings</i></b><p>From: bontchev@complex.is (Vesselin
        Bontchev)Newsgroups: alt.comp.virus<br>
        Subject: Re: McAfee VirusScan 3.0 and Fat32<br>
        Date: 11 Apr 1997 12:37:09 -0000<br>
        Organization: Frisk Software International<br>
        Message-ID: <a href="mailto:5ilb9l$m1i@banani.complex.is">5ilb9l$m1i@banani.complex.is</a><br>
        References: <a href="mailto:3349ba7e.17705931@news.dfwmm.net">3349ba7e.17705931@news.dfwmm.net</a><br>
        NNTP-Posting-Host: banani.complex.is<br>
        X-Newsreader: TIN [UNIX 1.3 950824BETA PL0]<br>
        Lines: 62<br>
        Xref: demon alt.comp.virus:59264</p>
        <p>David Levin
        (dlevin@dfwmm.net) wrote:<br>
        &gt; &quot;Chengi J. Kuo&quot;
        &lt;cjkuo@alumnae.caltech.edu&gt; wrote:<br>
        &gt;<br>
        &gt; &gt; 1) A Master Boot Record infection is
        independent of whether it's on a<br>
        &gt; &gt; FAT32 system or not. FAT32 is in boot sectors.
        If any virus infects the<br>
        &gt; &gt; MBR of a FAT32 machine, any present day AV can
        handle it.<br>
        &gt; <br>
        &gt; Then why in the activity log when I run your product
        does it say 'error<br>
        &gt; reading boot record'. How can it clean it if it
        can't read it ?</p>
        <p>The error occurs
        when reading the _DOS Boot Sector_ of the FAT32<br>
        partition - not when reading the MBR. The scanners have
        no problems<br>
        reading the MBR of a machine that has FAT32 partitions,
        finding viruses<br>
        in that MBR, and disinfecting them. It's the DBS that is
        problematic -<br>
        but, as Jimmy said, if the scanner reports a problem with
        that DBS, it<br>
        means that the DBS is *not* infected. If it becomes
        infected, the<br>
        scanner will be able to read it and disinfect it too.</p>
        <p>&gt; &gt; 2) There
        are no present day boot sector viruses which infect a
        FAT32 boot<br>
        &gt; &gt; sector and doesn't destroy it in the process.
        And in so doing, it<br>
        &gt; &gt; converts it into a FAT16 infected boot sector.
        So any present day<br>
        &gt; &gt; infected FAT32 system will be detectable by
        present day AV.<br>
        &gt; <br>
        &gt; It's one thing to detect a virus, it is another to
        CLEAN it. If the<br>
        &gt; virus converts the FAT32 boot record to a FAT16, how
        will McAfee CLEAN<br>
        &gt; it ?<br>
        
        The scanners in
        general and McAfee's scanner in particular have no<br>
        problems cleaning the boot records of FAT16 partitions.
        Since the<br>
        infected FAT32 partition looks like a FAT16 partition to
        the scanner, it<br>
        will have no problems cleaning it.</p>
        <p>&gt; It might be
        able to clean it to be an uninfected FAT16 boot record,<br>
        &gt; but it won't be able to convert it back to the
        original FAT32 boot<br>
        &gt; record</p>
        <p>Yes, it *will* be.
        Trust me - or try it for yourself, if you don't.<br>
        However, note that some of the existing boot sector
        viruses can *damage*<br>
        a FAT32 partition and make it non-bootable when infecting
        it. Removing<br>
        the virus won't restore the damage caused by it; you'll
        have to run SYS<br>
        on that partition.</p>
        <p>&gt; How can FAT32
        McAfee users be 'safe', when if a virus attacks their<br>
        &gt; boot sector, McAfee will not be able to CLEAN it or
        restore it from the<br>
        &gt; emergency disk ? </p>
        <p>It will be able to
        CLEAN it. Just as any other disinfector.</p>
        <p>&gt; In other words,
        their hard drive will probably be unusable.<br>
        <br>
        It might be non-bootable, but that would be caused by the
        virus, not by<br>
        the disinfector.</p>
        <p>Regards Vesselin</p>
        <p>-- <br>
        Vesselin Vladimirov Bontchev, not speaking for FRISK
        Software International,<br>
        Postholf 7180, IS-127, Reykjavik, Iceland producers of
        F-PROT.<br>
        e-mail: bontchev@complex.is, tel.: +354-561-7273, fax:
        +354-561-7274<br>
        PGP 2.6.2i key fingerprint: E5 FB 30 0C D4 AA AB 44 E5 F7
        C3 18 EA 2B AE 4E<br>
        </p>
        <p>From: &quot;Chengi
        J. Kuo&quot; <a href="mailto:cjkuo@alumnae.caltech.edu">cjkuo@alumnae.caltech.edu</a><br>
        Newsgroups: comp.virus<br>
        Subject: Re: McAfee VirusScan 3.0 and Fat32 (WIN95)<br>
        Date: 15 Apr 1997 13:19:14 -0000<br>
        Lines: 149<br>
        Sender: <a href="mailto:news@Lehigh.EDU">news@Lehigh.EDU</a><br>
        Approved: <a href="mailto:virus-l@Lehigh.EDU">virus-l@Lehigh.EDU</a><br>
        Message-ID: <a href="mailto:0021.01IHR6JG5DL09FNGZC@csc.canterbury.ac.nz">0021.01IHR6JG5DL09FNGZC@csc.canterbury.ac.nz</a><br>
        NNTP-Posting-Host: fidoii.cc.lehigh.edu<br>
        X-Date: Sat, 12 Apr 1997 20:24:04 +0000 (GMT)<br>
        X-Digest: Volume 10 : Issue 63</p>
        <p>David Levin
        &lt;dlevin@dfwmm.net&gt; writes:</p>
        <p>&gt;&quot;Chengi J.
        Kuo&quot; &lt;cjkuo@alumnae.caltech.edu&gt; wrote:</p>
        <p>Sigh. I hated
        writing my first response and now I must do it again.</p>
        <p>Mr. Levin,</p>
        <p>It is obvious that
        you have not been infected on the FAT32 system<br>
        and are making assumptions.</p>
        <p>&gt;&gt; 1) A Master
        Boot Record infection is independent of whether it's on a<br>
        &gt;&gt; FAT32 system or not. FAT32 is in boot sectors.
        If any virus infects the<br>
        &gt;&gt; MBR of a FAT32 machine, any present day AV can
        handle it.<br>
        &gt;<br>
        &gt;Then why in the activity log when I run your product
        does it say 'error<br>
        &gt;reading boot record'. How can it clean it if it can't
        read it ?</p>
        <p>Let me go back to
        the one point I made previously, &quot;And in so doing,
        it<br>
        converts it into a FAT16 infected boot sector.&quot; (see
        in point 2 below)</p>
        <p>No. It *is* clean.
        If it were infected, the virus would have turned it<br>
        into a FAT16 boot sector. And any present day AV would be
        able to handle<br>
        it. Even ones which do not claim to know about FAT32 boot
        sectors.</p>
        <p>Of course, after
        it's restored, and the next time you reboot, it's<br>
        FAT32 and our scanner will refuse to scan it. But it will
        be clean!</p>
        <p>And we will have
        restored it. (Not just us. Any current day product<br>
        will.) But as I noted earlier, the next version will
        support FAT32.</p>
        <p>&gt;&gt; 2) There
        are no present day boot sector viruses which infect a
        FAT32 boot<br>
        &gt;&gt; sector and doesn't destroy it in the process.
        And in so doing, it<br>
        &gt;&gt; converts it into a FAT16 infected boot sector.
        So any present day<br>
        &gt;&gt; infected FAT32 system will be detectable by
        present day AV.<br>
        &gt;</p>
        <p>&gt;It's one thing
        to detect a virus, it is another to CLEAN it. If the<br>
        &gt;virus converts the FAT32 boot record to a FAT16, how
        will McAfee CLEAN<br>
        &gt;it ?</p>
        <p>Generally, it cleans
        by finding the original boot sector. It does this<br>
        by knowing, &quot;I've found XYZ. XYZ relocates the
        original to (cylinder,<br>
        track,sector). Get it. Put it back.&quot; It matters not
        what the original<br>
        was. (You may now join into the debate between Mr.
        Bontchev and one of<br>
        his customers about the validity of this approach.)</p>
        <p>&gt; It might be
        able to clean it to be an uninfected FAT16 boot<br>
        &gt;record, but it won't be able to convert it back to
        the original FAT32<br>
        &gt;boot record since McAfee STILL does not support it
        (after 7+ months<br>
        &gt;since WIN95 OSR2 came out).</p>
        <p>This is an incorrect
        assumption. See above.</p>
        <p>&gt; The emergency
        disk will be no help, because<br>
        &gt;unlike Norton, McAfee does not back up the Boot
        record to the emergency<br>
        &gt;disk. </p>
        <p>This is correct.</p>
        <p>&gt;&gt; 3) What
        does FAT32 support mean? It means if you're up and
        running on<br>
        &gt;&gt; FAT32, you don't get the &quot;cannot
        access&quot; message. But if you get that<br>
        &gt;&gt; message today, you're clean!<br>
        &gt;&gt;<br>
        &gt;&gt; The fact is, the same reason why AV had to be
        rewritten, none of the <br>
        &gt;&gt; viruses understand FAT32 either.<br>
        &gt;&gt;<br>
        &gt;&gt; On the question of whether we support FAT32.
        Version 3.0 was supposed to.<br>
        &gt;&gt; But it didn't make it. But you can find FAT32
        support in today's beta.<br>
        &gt;&gt; And it will be in 3.0.2.<br>
        &gt;<br>
        &gt;It is still not on your BETA site. How many more
        months will it take to<br>
        &gt;support FAT32 ?</p>
        <p>Are you looking for
        the DOS version or the 95 version? Only the DOS<br>
        version is available there
        (http://beta.mcafee.com/public/datafiles).<br>
        (And the next DOS version will be numbered 3.0.1.)</p>
        <p>The next DOS version
        will be released this month. The other platforms to<br>
        follow shortly.</p>
        <p>&gt;&gt; So in
        direct response to the suggestion that McAfee users are
        not safe<br>
        &gt;&gt; if using a FAT32 system, you are incorrect.
        McAfee users today are safe.<br>
        &gt;&gt; And furthermore, there are no boot sector
        viruses that correctly infect<br>
        &gt;&gt; a FAT32 boot sector today.<br>
        &gt;<br>
        &gt;How can FAT32 McAfee users be 'safe', when if a virus
        attacks their<br>
        &gt;boot sector, McAfee will not be able to CLEAN it or
        restore it from the<br>
        &gt;emergency disk ?</p>
        <p>An incorrect
        statement. I covered that above.</p>
        <p>&gt; In other words,
        their hard drive will probably be unusable.</p>
        <p>An incorrect
        assumption.</p>
        <p>&gt; Why is this
        incapability problem not stated in the<br>
        &gt;documentation or in the 'Know Issues' section of the
        Read Me file ?</p>
        <p>Since we made no
        claims of FAT32 compatibility, I didn't see a need to<br>
        have such a warning. Since there are no FAT32 boot sector
        viruses, there<br>
        is no &quot;issue&quot; to be &quot;known.&quot;</p>
        <p>Now, if we made such
        a claim and it was not true, that would be an issue<br>
        where I would go and berate someone.</p>
        <p>&gt; Why is it
        taking so long to support an operation/disk system that
        came out<br>
        &gt;over 7 months ago ? Your competitors have.</p>
        <p>Ah. Someone is
        questioning my decision making in supporting our users.<br>
        (Those were my decisions and they do represent McAfee's
        position on this.)<br>
        [I pulled up my other response to you. But apparently,
        you changed your<br>
        question from &quot;8 months&quot; to &quot;7
        months&quot;. No matter. It'll be 8 months<br>
        soon enough.]</p>
        <p>We've been
        concentrating on macro viruses because *I* think it's<br>
        more important. In the 8 months, there hasn't been a
        native FAT32<br>
        boot virus.</p>
        <p>Would you ask our
        &quot;competitors&quot; who support FAT32 how their
        Office97<br>
        support compares to McAfee's? Office97 was released in
        January. We<br>
        had betas available immediately. And we shipped late Feb.
        The first<br>
        Word97 virus was dicovered on a Microsoft Web site late
        January or<br>
        early February. Only 2 products at the time, I believe,
        could even claim<br>
        to be able to handle it. I think we're approaching 10
        such beasts<br>
        now. I think there's 4 or 5 companies claiming to handle
        them.</p>
        <p>I'm glad there are
        companies who feel a compunction to supply you with<br>
        FAT32 support. One such company you mentioned earlier
        also claimed<br>
        they could detect all Java viruses last year. My
        marketing people<br>
        were on me immediately. &quot;Look,&quot; I said,
        &quot;we detect all the Java<br>
        viruses there are. No changes necessary. And a year from
        now, it'll<br>
        still be true.&quot; (It's a year now.)</p>
        <p>All companies I'm
        sure have limited resources. I have to assign my<br>
        people to where I assess the dangers will be for our
        customers.</p>
        <p>But, as I said, our
        next version will have FAT32 support. But, I will<br>
        also tell those people who do not quickly upgrade to that
        version.</p>
        <p>&quot;Look, we
        detect all FAT32 viruses there are. No changes necessary.<br>
        And many months from now, it'll still be true.&quot;</p>
        <p>Mr. Levin, unless
        you're not a user of Word and Excel, you will come to<br>
        realize that the time we have spent to crack OLE2 and
        Office97 (and<br>
        de facto, Word6 and 7 and Excel 5) will be more
        significant to you in<br>
        the near term as well as the long run.</p>
        <p>Jimmy Kuo<br>
        Director, AV Research<br>
        <a href="mailto:cjkuo@mcafee.com">cjkuo@mcafee.com</a></p>
        <p>&nbsp;</p>
        <p>From: Nick
        FitzGerald <a href="mailto:n.fitzgerald@csc.canterbury.ac.nz">n.fitzgerald@csc.canterbury.ac.nz</a><br>
        Newsgroups: comp.virus<br>
        Subject: Re: Please clarify some FAT32 issues (WIN95)<br>
        Date: 15 Apr 1997 13:19:12 -0000<br>
        Lines: 80<br>
        Sender: <a href="mailto:news@Lehigh.EDU">news@Lehigh.EDU</a><br>
        Approved: <a href="mailto:virus-l@Lehigh.EDU">virus-l@Lehigh.EDU</a><br>
        Message-ID: <a href="mailto:0020.01IHR6JG5DL09FNGZC@csc.canterbury.ac.nz">0020.01IHR6JG5DL09FNGZC@csc.canterbury.ac.nz</a><br>
        NNTP-Posting-Host: fidoii.cc.lehigh.edu<br>
        X-Date: Fri, 28 Mar 1997 10:10:02 +1300<br>
        X-Digest: Volume 10 : Issue 63</p>
        <p>John Humphries
        &lt;jh@sherpanet.com&gt; wrote:</p>
        <p>&gt; Reading the
        moderator's note appended to Doug Muth's &quot;Re:
        onehalf.mbr &amp;<br>
        &gt; win95 problem&quot; I'm left somewhat confused. The
        pre-pended note says<br>
        &gt; &quot;...the important thing about booting clean is
        to do so with a non-Win95<br>
        &gt; boot disk...&quot;: will files on a FAT32 disk be
        accessible when booted from<br>
        &gt; an earlier version of DOS (e.g., DOS6.22)?</p>
        <p>No. MS-DOS 7, build
        950 (the one that reports &quot;Windows 95. [Version<br>
        4.00.950]&quot; in response to the VER command) and all
        earlier DOSes (MS and<br>
        others) do not &quot;understand&quot; the FAT32 file
        allocation system *and* could<br>
        otherwise be tripped up by other aspects of the FAT32
        file system.</p>
        <p>My recommendation
        when facing an MBR infection on a Windows 95 machine is<br>
        to boot with a pre-Win95 DOS diskette. This is true of
        &quot;classic&quot; Win95<br>
        and OSR2 systems (whether the latter have FAT32 drives or
        not). This is<br>
        because of a difference in operation between earlier
        DOSes and MS-DOS 7<br>
        that means very often your AV software will warn you that
        the virus is &quot;in<br>
        memory&quot; (and usually refuse to continue!) even
        though you really have<br>
        &quot;booted clean&quot;. I recently learned (thanks
        Ilia) that this ghost positive<br>
        problem is easily averted with MS-DOS 7 by the simple
        expedience of<br>
        setting BUFFERS=5 in the CONFIG.SYS file on your boot
        floppy (for some of<br>
        the technical details look in the archives for digests
        around V10 #50-52--<br>
        also Jimmy Kuo addresses some of these issues in a post
        in this Digest).</p>
        <p>&gt; The post-pended
        note says &quot;...with Win95 OSR2's FAT32 you may need
        an<br>
        &gt; updated DOS AV s/w...&quot;: what are some examples
        of such software,<br>
        &gt; especially are there any shareware versions which
        can freely distributed<br>
        &gt; to people?</p>
        <p>I'll leave it to the
        vendors to answer this...</p>
        <p>However, the issues
        are that with FAT32 the (D)OS Boot Sector is not as<br>
        simple or rigid a structure as it has been, and a few new
        avenues of<br>
        infection are probably possible under FAT32. The
        potentially &quot;mobile&quot;<br>
        nature of various parts of the FAT32 file system that are
        accessed after<br>
        the MBR during the boot process means that (eventually)
        FAT32-aware AV s/w<br>
        will be necessary. However, although I referred to it as
        &quot;DOS AV s/w&quot; it<br>
        may be that such s/w will require a DOS 7 build 1111
        (that which comes<br>
        with OSR2) or later to perform FAT32 disk and file I/O.</p>
        <p>To the best of my
        knowledge, as I am writing this, there are no known<br>
        viruses that utilize any FAT32-specific attack methods.</p>
        <p>&gt; The note goes
        on &quot;...deal with DBS infectors (see recent
        thread)...&quot;:<br>
        &gt; searching through DejaNews about a week ago I was
        unable to find any<br>
        &gt; references to DBS in their comp.virus archive -
        where can I find this?</p>
        <p>There had been
        several posts mentioning FAT32 support and querying
        whether<br>
        certain products had it or not. Some of these have been
        posted in the<br>
        interim between John submitting his post and my response.
        Hopefully these<br>
        have (helped) answer the question.</p>
        <p>&gt; Still more
        &quot;...MBR infectors should still be dealt with on
        FAT32 drives<br>
        &gt; with 'old' DOS AV's...&quot;; does this mean that we
        need to boot with a<br>
        &gt; pre-FAT32 disk to check for MBR/boot sector viruses
        and with a FAT32<br>
        &gt; disk to check for file infectors and macro viruses?</p>
        <p>That will work, but
        was not (literally) what I meant. Had I written that<br>
        more coherently (aka &quot;less hurriedly&quot;) I may
        have written &quot;'old' DOS AV's<br>
        should still be able to deal with MBR infectors on FAT32
        drives...&quot;.</p>
        <p>FAT32-aware AVs
        should be able to deal with MBR, DBS and file viruses (so<br>
        long as you work around that false positive problem I
        mentioned earlier).</p>
        <p>&gt; I'm painfully
        aware that my understanding of these issues is sketchy at<br>
        &gt; best, so please answer (or, at least raise) the
        questions that I should<br>
        &gt; have asked about FAT32 (but didn't know enough to
        frame them) as well<br>
        &gt; as the few that I managed to put into words.</p>
        <p>Well, you certainly
        picked up a few too-roughly-sketched-out comments of<br>
        mine...</p>
        <p>Hope that helps!</p>
        <p>+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+<br>
        Nick FitzGerald, PC Applications Consultant, CSC, Uni of
        Canterbury, N.Z.<br>
        n.fitzgerald@csc.canterbury.ac.nz TEL:+64 3 364 2337,
        FAX:+64 3 364 2332<br>
        Virus-L/comp.virus moderator and FAQ maintainer<br>
        PGP fingerprint = 2E 7D E9 0C DE 26 24 4F 1F 43 91 B9 C4
        05 C9 83</p>
        <p>&nbsp;</p>
        </td>
    </tr>
    <tr>
        <td><b>References<br>
        </b>[Kuo] Jimmy Kuo, Public Posting To The
        Alt.Comp.Virus Newsgroup. <br>
        [Bontchev] Vesselin Bontchev, Public Posting To The
        Alt.Comp.Virus Newsgroup.<br>
        [Fitzgerald] Nick Fitzgerald, Public Posting To The
        Alt.Comp.Virus Newsgroup.<br>
        [Overton] Martin Overton, Anti-Virus in the Corporate
        Arena Virus Bulletin Conference 1996.<br>
        [Whalley] Ian Whalley, Viruses in Chicago: The Threat to
        Windows 95 IVPC '96.<br>
        [MS]Microsoft, MSDN Web Site.<br>
        [Dr. Sol] Dr. Solomon's Virus Alert. <br>
        [Emm] David Emm, Windows 95 and Viruses Dr. Solomon's
        Technical Paper.<br>
        [CN] Carey Nachenburg.<br>
        [VB2] Virus Bulletin, Viruses on Windows 95 Virus
        Bulletin - June 1995 pp15-17</td>
    </tr>
    <tr>
        <td>&nbsp;</td>
    </tr>
</table>
</center></div>
</body>

<!-- Mirrored from vx.netlux.org/texts/html/fat32new.html by HTTrack Website Copier/3.x [XR&CO'2003], Wed, 02 Jul 2003 18:11:14 GMT -->
</html>
